var Z=Object.defineProperty;var L=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var x=(p,t,u)=>t in p?Z(p,t,{enumerable:!0,configurable:!0,writable:!0,value:u}):p[t]=u,F=(p,t)=>{for(var u in t||(t={}))ee.call(t,u)&&x(p,u,t[u]);if(L)for(var u of L(t))te.call(t,u)&&x(p,u,t[u]);return p};import{J as se,aN as oe,G as ae,B as h,k as v,L as l,M as U,N as w,O as k,Q as ne,P as re,R as le,S as $,T as ie,r as m,o as y,l as j,w as i,h as _,f as s,m as ue,i as de,t as V,u as e,j as G,e as me,U as ce}from"./vendor.ae2d842a.js";import{l as pe,m as ge,d as _e,b as fe}from"./main.88a58514.js";import{u as he}from"./users.0b2a2e37.js";import{_ as ve}from"./CreateCustomFields.804fde6c.js";const Ce=["onSubmit"],be={class:"flex items-center justify-end"},Be={class:"grid grid-cols-5 gap-4 mb-8"},$e={class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},we={class:"grid grid-cols-5 gap-2 mb-8"},ye={key:0,class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},Ve={class:"col-span-5 lg:col-span-4"},xe={setup(p){const t=pe(),u=ge(),N=_e(),P=fe(),M=he(),S="customFields",{t:a}=se(),D=oe(),A=ae();let c=h(!1);h(!1),h(!1),h(!1);const C=h(!1),f=v(()=>A.name==="customers.edit");let R=v(()=>t.isFetchingInitialSettings);const I=v(()=>f.value?a("customers.edit_customer"):a("customers.new_customer")),T=v(()=>({currentCustomer:{name:{required:l.withMessage(a("validation.required"),U),minLength:l.withMessage(a("validation.name_min_length",{count:3}),w(3))},prefix:{minLength:l.withMessage(a("validation.name_min_length",{count:3}),w(3))},currency_id:{required:l.withMessage(a("validation.required"),U)},email:{required:l.withMessage(a("validation.required"),k(t.currentCustomer.enable_portal==!0)),email:l.withMessage(a("validation.email_incorrect"),ne)},password:{required:l.withMessage(a("validation.required"),k(t.currentCustomer.enable_portal==!0&&!t.currentCustomer.password_added)),minLength:l.withMessage(a("validation.password_min_length",{count:8}),w(8))},confirm_password:{sameAsPassword:l.withMessage(a("validation.password_incorrect"),re(t.currentCustomer.password))},website:{url:l.withMessage(a("validation.invalid_url"),le)},billing:{address_street_1:{maxLength:l.withMessage(a("validation.address_maxlength",{count:255}),$(255))},address_street_2:{maxLength:l.withMessage(a("validation.address_maxlength",{count:255}),$(255))}},shipping:{address_street_1:{maxLength:l.withMessage(a("validation.address_maxlength",{count:255}),$(255))},address_street_2:{maxLength:l.withMessage(a("validation.address_maxlength",{count:255}),$(255))}}}}));v(()=>`${window.location.origin}/${P.selectedCompany.slug}/customer/login`);const d=ie(T,t,{$scope:S});t.resetCurrentCustomer(),t.fetchCustomerInitialSettings(f.value),M.fetchUsers();async function E(){if(d.value.$touch(),d.value.$invalid)return!0;C.value=!0;let n=F({},t.currentCustomer),o=null;try{o=await(f.value?t.updateCustomer:t.addCustomer)(n)}catch{C.value=!1;return}D.push(`/admin/customers/${o.data.data.id}/view`)}return(n,o)=>{const b=m("BaseBreadcrumbItem"),H=m("BaseBreadcrumb-item"),z=m("BaseBreadcrumb"),J=m("BaseIcon"),O=m("BaseButton"),Q=m("BasePageHeader"),B=m("BaseInput"),g=m("BaseInputGroup"),q=m("BaseMultiselect"),K=m("BaseInputGrid"),W=m("BaseDivider"),X=m("BaseCard"),Y=m("BasePage");return y(),j(Y,null,{default:i(()=>[_("form",{onSubmit:ce(E,["prevent"])},[s(Q,{title:e(I)},{actions:i(()=>[_("div",be,[s(O,{type:"submit",loading:C.value,disabled:C.value},{left:i(r=>[s(J,{name:"SaveIcon",class:ue(r.class)},null,8,["class"])]),default:i(()=>[de(" "+V(e(f)?n.$t("customers.update_customer"):n.$t("customers.save_customer")),1)]),_:1},8,["loading","disabled"])])]),default:i(()=>[s(z,null,{default:i(()=>[s(b,{title:n.$t("general.home"),to:"dashboard"},null,8,["title"]),s(b,{title:n.$tc("customers.customer",2),to:"/admin/customers"},null,8,["title"]),s(H,{title:e(I),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),s(X,{class:"mt-5"},{default:i(()=>[_("div",Be,[_("h6",$e,V(n.$t("customers.basic_info")),1),s(K,{class:"col-span-5 lg:col-span-4"},{default:i(()=>[s(g,{label:n.$t("customers.display_name"),required:"",error:e(d).currentCustomer.name.$error&&e(d).currentCustomer.name.$errors[0].$message,"content-loading":e(c)},{default:i(()=>[s(B,{modelValue:e(t).currentCustomer.name,"onUpdate:modelValue":o[0]||(o[0]=r=>e(t).currentCustomer.name=r),"content-loading":e(c),type:"text",name:"name",class:"",invalid:e(d).currentCustomer.name.$error,onInput:o[1]||(o[1]=r=>e(d).currentCustomer.name.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","error","content-loading"]),s(g,{label:n.$t("customers.primary_contact_name"),"content-loading":e(c)},{default:i(()=>[s(B,{modelValue:e(t).currentCustomer.contact_name,"onUpdate:modelValue":o[2]||(o[2]=r=>e(t).currentCustomer.contact_name=r),modelModifiers:{trim:!0},"content-loading":e(c),type:"text"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),s(g,{error:e(d).currentCustomer.email.$error&&e(d).currentCustomer.email.$errors[0].$message,"content-loading":e(c),label:n.$t("customers.email")},{default:i(()=>[s(B,{modelValue:e(t).currentCustomer.email,"onUpdate:modelValue":o[3]||(o[3]=r=>e(t).currentCustomer.email=r),modelModifiers:{trim:!0},"content-loading":e(c),type:"text",name:"email",invalid:e(d).currentCustomer.email.$error,onInput:o[4]||(o[4]=r=>e(d).currentCustomer.email.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["error","content-loading","label"]),s(g,{label:n.$t("customers.phone"),"content-loading":e(c)},{default:i(()=>[s(B,{modelValue:e(t).currentCustomer.phone,"onUpdate:modelValue":o[5]||(o[5]=r=>e(t).currentCustomer.phone=r),modelModifiers:{trim:!0},"content-loading":e(c),type:"text",name:"phone"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),s(g,{label:n.$t("customers.primary_currency"),"content-loading":e(c),error:e(d).currentCustomer.currency_id.$error&&e(d).currentCustomer.currency_id.$errors[0].$message,required:""},{default:i(()=>[s(q,{modelValue:e(t).currentCustomer.currency_id,"onUpdate:modelValue":o[6]||(o[6]=r=>e(t).currentCustomer.currency_id=r),"value-prop":"id",label:"name","track-by":"name","content-loading":e(c),options:e(N).currencies,searchable:"","can-deselect":!1,placeholder:n.$t("customers.select_currency"),invalid:e(d).currentCustomer.currency_id.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","content-loading","error"]),s(g,{label:"Asesor","content-loading":e(c),required:""},{default:i(()=>[s(q,{modelValue:e(t).currentCustomer.manager_id,"onUpdate:modelValue":o[7]||(o[7]=r=>e(t).currentCustomer.manager_id=r),"value-prop":"id",label:"name","track-by":"name","content-loading":e(c),options:e(M).users,searchable:"","can-deselect":!1,placeholder:n.$t("customers.manager"),class:"w-full"},null,8,["modelValue","content-loading","options","placeholder"])]),_:1},8,["content-loading"])]),_:1})]),e(u).customFields.length>0?(y(),j(W,{key:0,class:"mb-5 md:mb-8"})):G("",!0),_("div",we,[e(u).customFields.length>0?(y(),me("h6",ye,V(n.$t("settings.custom_fields.title")),1)):G("",!0),_("div",Ve,[s(ve,{type:"Customer",store:e(t),"store-prop":"currentCustomer","is-edit":e(f),"is-loading":e(R),"custom-field-scope":S},null,8,["store","is-edit","is-loading"])])])]),_:1})],40,Ce)]),_:1})}}};export{xe as default};
