var Ie=Object.defineProperty,Se=Object.defineProperties;var Te=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var ke=Object.prototype.hasOwnProperty,Pe=Object.prototype.propertyIsEnumerable;var ye=(s,t,e)=>t in s?Ie(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,N=(s,t)=>{for(var e in t||(t={}))ke.call(t,e)&&ye(s,e,t[e]);if(pe)for(var e of pe(t))Pe.call(t,e)&&ye(s,e,t[e]);return s},G=(s,t)=>Se(s,Te(t));import{p as ee,c as J,e as ae,b as te,o as xe,g as ne,T as Ce,k as Me,u as De,d as Ve}from"./main.88a58514.js";import{D as je,d as qe}from"./DragIcon.b567ebba.js";import{B as W,a0 as fe,ah as re,J as Z,k as $,C as le,r as x,o as l,e as v,h as n,t as b,f as a,V as Ee,u as o,w as u,i as L,l as q,j as A,G as Le,A as X,L as z,M as R,b2 as _e,S as oe,aX as Ae,T as ie,x as K,F as Q,y as se,H as ge,a7 as Ue,W as ze,m as H,Y as Oe,X as Ne,Z as Fe,N as Ye,D as he,U as be}from"./vendor.ae2d842a.js";const Ge={class:"flex items-center justify-between mb-3"},We={class:"flex items-center text-base",style:{flex:"4"}},Re={class:"pr-2 mb-0",align:"right"},Xe={class:"absolute left-3.5"},He={class:"ml-2 text-sm leading-none cursor-pointer text-primary-400"},Je=n("br",null,null,-1),Ze={class:"text-sm text-right",style:{flex:"3"}},Ke={class:"flex items-center justify-center w-6 h-10 mx-2 cursor-pointer"},Qe={props:{ability:{type:String,default:""},store:{type:Object,default:null},storeProp:{type:String,default:""},itemIndex:{type:Number,required:!0},index:{type:Number,required:!0},taxData:{type:Object,required:!0},taxes:{type:Array,default:[]},total:{type:Number,default:0},totalTax:{type:Number,default:0},discountedTotal:{type:Number,default:0},currency:{type:[Object,String],required:!0},updateItems:{type:Function,default:()=>{}}},emits:["remove","update"],setup(s,{emit:t}){const e=s,i=ee(),T=J(),w=ae(),I=W(null),f=fe(N({},e.taxData));re("utils");const{t:V}=Z(),p=$(()=>i.taxTypes.map(c=>N({},c)).map(c=>(e.taxes.find(y=>y.tax_type_id===c.id)?c.disabled=!0:c.disabled=!1,c))),j=$(()=>f.compound_tax&&e.discountedTotal?(e.discountedTotal+e.totalTax)*f.percent/100:e.discountedTotal&&f.percent?e.discountedTotal*f.percent/100:0);le(()=>e.discountedTotal,()=>{P()}),le(()=>e.totalTax,()=>{P()}),e.taxData.tax_type_id>0&&(I.value=i.taxTypes.find(m=>m.id===e.taxData.tax_type_id)),P();function D(m){f.percent=m.percent,f.tax_type_id=m.id,f.compound_tax=m.compound_tax,f.name=m.name,P()}function P(){f.tax_type_id!==0&&t("update",{index:e.index,item:G(N({},f),{amount:j.value})})}function d(){let m={itemIndex:e.itemIndex,taxIndex:e.index};T.openModal({title:V("settings.tax_types.add_tax"),componentName:"TaxTypeModal",data:m,size:"sm"})}function r(m){e.store.$patch(c=>{c[e.storeProp].items[e.itemIndex].taxes.splice(m,1)})}return(m,c)=>{const k=x("BaseIcon"),y=x("BaseMultiselect"),M=x("BaseFormatMoney");return l(),v("div",Ge,[n("div",We,[n("label",Re,b(m.$t("invoices.item.tax")),1),a(y,{modelValue:I.value,"onUpdate:modelValue":[c[0]||(c[0]=C=>I.value=C),c[1]||(c[1]=C=>D(C))],"value-prop":"id",options:o(p),placeholder:m.$t("general.select_a_tax"),"open-direction":"top","track-by":"name",searchable:"",object:"",label:"name"},Ee({singlelabel:u(({value:C})=>[n("div",Xe,b(C.name)+" - "+b(C.percent)+" % ",1)]),option:u(({option:C})=>[L(b(C.name)+" - "+b(C.percent)+" % ",1)]),_:2},[o(w).hasAbilities(s.ability)?{name:"action",fn:u(()=>[n("button",{type:"button",class:"flex items-center justify-center w-full px-2 py-2 bg-gray-200 border-none outline-none cursor-pointer",onClick:d},[a(k,{name:"CheckCircleIcon",class:"h-5 text-primary-400"}),n("label",He,b(m.$t("invoices.add_new_tax")),1)])])}:void 0]),1032,["modelValue","options","placeholder"]),Je]),n("div",Ze,[a(M,{amount:o(j),currency:s.currency},null,8,["amount","currency"])]),n("div",Ke,[s.taxes.length&&s.index!==s.taxes.length-1?(l(),q(k,{key:0,name:"TrashIcon",class:"h-5 text-gray-700 cursor-pointer",onClick:c[2]||(c[2]=C=>r(s.index))})):A("",!0)])])}}},et={class:"box-border bg-white border border-gray-200 border-solid rounded-b"},tt={colspan:"5",class:"p-0 text-left align-top"},st={class:"w-full"},ot=n("col",{style:{width:"40%","min-width":"280px"}},null,-1),at=n("col",{style:{width:"10%","min-width":"120px"}},null,-1),nt=n("col",{style:{width:"15%","min-width":"120px"}},null,-1),rt={key:0,style:{width:"15%","min-width":"160px"}},lt=n("col",{style:{width:"15%","min-width":"120px"}},null,-1),it={class:"px-5 py-4 text-left align-top"},dt={class:"flex justify-start"},ct={class:"flex items-center justify-center w-5 h-5 mt-2 mr-2 text-gray-300 cursor-move handle"},ut={class:"px-5 py-4 text-right align-top"},mt={class:"px-5 py-4 text-left align-top"},pt={class:"flex flex-col"},yt={class:"flex-auto flex-fill bd-highlight"},xt={class:"relative w-full"},ft={key:0,class:"px-5 py-4 text-left align-top"},_t={class:"flex flex-col"},gt={class:"flex",style:{width:"120px"},role:"group"},ht={class:"flex items-center"},bt={class:"px-5 py-4 text-right align-top"},vt={class:"flex items-center justify-end text-sm"},$t={class:"flex items-center justify-center w-6 h-10 mx-2"},wt={key:0},Bt=n("td",{class:"px-5 py-4 text-left align-top"},null,-1),It={colspan:"4",class:"px-5 py-4 text-left align-top"},St={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},itemData:{type:Object,default:null},index:{type:Number,default:null},type:{type:String,default:""},loading:{type:Boolean,default:!1},currency:{type:[Object,String],required:!0},invoiceItems:{type:Array,required:!0},itemValidationScope:{type:String,default:""}},emits:["update","remove","itemValidate"],setup(s,{emit:t}){const e=s,i=te(),T=xe();Le();const{t:w}=Z(),I=$({get:()=>e.itemData.quantity,set:g=>{E("quantity",parseFloat(g))}}),f=$({get:()=>{const g=e.itemData.price;return parseFloat(g)>0?g/100:g},set:g=>{if(parseFloat(g)>0){let S=Math.round(g*100);E("price",S)}else E("price",g)}}),V=$(()=>e.itemData.price*e.itemData.quantity),p=$({get:()=>e.itemData.discount,set:g=>{e.itemData.discount_type==="percentage"?E("discount_val",V.value*g/100):E("discount_val",Math.round(g*100)),E("discount",g)}}),j=$(()=>V.value-e.itemData.discount_val),D=$(()=>e.currency?e.currency:i.selectedCompanyCurrency),P=$(()=>e.store[e.storeProp].items.length!=1),d=$(()=>Math.round(X.exports.sumBy(e.itemData.taxes,function(g){return g.compound_tax?0:g.amount}))),r=$(()=>Math.round(X.exports.sumBy(e.itemData.taxes,function(g){return g.compound_tax?g.amount:0}))),m=$(()=>d.value+r.value),c={name:{required:z.withMessage(w("validation.required"),R)},quantity:{required:z.withMessage(w("validation.required"),R),minValue:z.withMessage(w("validation.qty_must_greater_than_zero"),_e(0)),maxLength:z.withMessage(w("validation.amount_maxlength"),oe(20))},price:{required:z.withMessage(w("validation.required"),R),minValue:z.withMessage(w("validation.number_length_minvalue"),_e(1)),maxLength:z.withMessage(w("validation.price_maxlength"),oe(20))},discount_val:{between:z.withMessage(w("validation.discount_maxlength"),Ae(0,$(()=>V.value)))},description:{maxLength:z.withMessage(w("validation.notes_maxlength"),oe(65e3))}},k=ie(c,$(()=>e.store[e.storeProp].items[e.index]),{$scope:e.itemValidationScope});function y(g){e.store.$patch(U=>{U[e.storeProp].items[e.index].taxes[g.index]=g.item});let S=e.itemData.taxes[e.itemData.taxes.length-1];(S==null?void 0:S.tax_type_id)!==0&&e.store.$patch(U=>{U[e.storeProp].items[e.index].taxes.push(G(N({},Ce),{id:ge.raw()}))}),B()}function M(g){E("name",g)}function C(g){e.store.$patch(S=>{if(S[e.storeProp].items[e.index].name=g.name,S[e.storeProp].items[e.index].price=g.price,S[e.storeProp].items[e.index].item_id=g.id,S[e.storeProp].items[e.index].description=g.description,g.unit&&(S[e.storeProp].items[e.index].unit_name=g.unit.name),e.store[e.storeProp].tax_per_item==="YES"&&g.taxes){let U=0;g.taxes.forEach(Y=>{y({index:U,item:N({},Y)}),U++})}S[e.storeProp].exchange_rate&&(S[e.storeProp].items[e.index].price/=S[e.storeProp].exchange_rate)}),T.fetchItems(),B()}function _(){e.itemData.discount_type!=="fixed"&&(E("discount_val",Math.round(e.itemData.discount*100)),E("discount_type","fixed"))}function h(){e.itemData.discount_type!=="percentage"&&(E("discount_val",V.value*e.itemData.discount/100),E("discount_type","percentage"))}function B(){var U,Y;let g=(Y=(U=e.store[e.storeProp])==null?void 0:U.items[e.index])==null?void 0:Y.taxes;g||(g=[]);let S=G(N({},e.store[e.storeProp].items[e.index]),{index:e.index,total:j.value,sub_total:V.value,totalSimpleTax:d.value,totalCompoundTax:r.value,totalTax:m.value,tax:m.value,taxes:[...g]});e.store.updateItem(S)}function E(g,S){e.store.$patch(U=>{U[e.storeProp].items[e.index][g]=S}),B()}return(g,S)=>{const U=x("BaseItemSelect"),Y=x("BaseInput"),O=x("BaseMoney"),de=x("BaseIcon"),ve=x("BaseButton"),ce=x("BaseDropdownItem"),$e=x("BaseDropdown"),ue=x("BaseContentPlaceholdersText"),me=x("BaseContentPlaceholders"),we=x("BaseFormatMoney");return l(),v("tr",et,[n("td",tt,[n("table",st,[n("colgroup",null,[ot,at,nt,s.store[s.storeProp].discount_per_item==="YES"?(l(),v("col",rt)):A("",!0),lt]),n("tbody",null,[n("tr",null,[n("td",it,[n("div",dt,[n("div",ct,[a(je)]),a(U,{type:"Invoice",item:s.itemData,invalid:o(k).name.$error,"invalid-description":o(k).description.$error,taxes:s.itemData.taxes,index:s.index,"store-prop":s.storeProp,store:s.store,onSearch:M,onSelect:C},null,8,["item","invalid","invalid-description","taxes","index","store-prop","store"])])]),n("td",ut,[a(Y,{modelValue:o(I),"onUpdate:modelValue":S[0]||(S[0]=F=>K(I)?I.value=F:null),invalid:o(k).quantity.$error,"content-loading":s.loading,type:"number",small:"",min:"0",step:"any",onChange:S[1]||(S[1]=F=>B()),onInput:S[2]||(S[2]=F=>o(k).quantity.$touch())},null,8,["modelValue","invalid","content-loading"])]),n("td",mt,[n("div",pt,[n("div",yt,[n("div",xt,[a(O,{key:o(D),modelValue:o(f),"onUpdate:modelValue":S[3]||(S[3]=F=>K(f)?f.value=F:null),invalid:o(k).price.$error,"content-loading":s.loading,currency:o(D)},null,8,["modelValue","invalid","content-loading","currency"])])])])]),s.store[s.storeProp].discount_per_item==="YES"?(l(),v("td",ft,[n("div",_t,[n("div",gt,[a(Y,{modelValue:o(p),"onUpdate:modelValue":S[4]||(S[4]=F=>K(p)?p.value=F:null),invalid:o(k).discount_val.$error,"content-loading":s.loading,class:"border-r-0 focus:border-r-2 rounded-tr-sm rounded-br-sm h-[38px]"},null,8,["modelValue","invalid","content-loading"]),a($e,{position:"bottom-end"},{activator:u(()=>[a(ve,{"content-loading":s.loading,class:"rounded-tr-md rounded-br-md !p-2 rounded-none",type:"button",variant:"white"},{default:u(()=>[n("span",ht,[L(b(s.itemData.discount_type=="fixed"?s.currency.symbol:"%")+" ",1),a(de,{name:"ChevronDownIcon",class:"w-4 h-4 ml-1 text-gray-500"})])]),_:1},8,["content-loading"])]),default:u(()=>[a(ce,{onClick:_},{default:u(()=>[L(b(g.$t("general.fixed")),1)]),_:1}),a(ce,{onClick:h},{default:u(()=>[L(b(g.$t("general.percentage")),1)]),_:1})]),_:1})])])])):A("",!0),n("td",bt,[n("div",vt,[n("span",null,[s.loading?(l(),q(me,{key:0},{default:u(()=>[a(ue,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),q(we,{key:1,amount:o(j),currency:o(D)},null,8,["amount","currency"]))]),n("div",$t,[o(P)?(l(),q(de,{key:0,class:"h-5 text-gray-700 cursor-pointer",name:"TrashIcon",onClick:S[5]||(S[5]=F=>s.store.removeItem(s.index))})):A("",!0)])])])]),s.store[s.storeProp].tax_per_item==="YES"?(l(),v("tr",wt,[Bt,n("td",It,[s.loading?(l(),q(me,{key:0},{default:u(()=>[a(ue,{lines:1,class:"w-24 h-8 border rounded-md"})]),_:1})):(l(!0),v(Q,{key:1},se(s.itemData.taxes,(F,Be)=>(l(),q(Qe,{key:F.id,index:Be,"item-index":s.index,"tax-data":F,taxes:s.itemData.taxes,"discounted-total":o(j),"total-tax":o(d),total:o(V),currency:s.currency,"update-items":B,ability:o(ne).CREATE_INVOICE,store:s.store,"store-prop":s.storeProp,discount:o(p),onUpdate:y},null,8,["index","item-index","tax-data","taxes","discounted-total","total-tax","total","currency","ability","store","store-prop","discount"]))),128))])])):A("",!0)])])])])}}},Tt={class:"text-center item-table min-w-full"},kt=n("col",{style:{width:"40%","min-width":"280px"}},null,-1),Pt=n("col",{style:{width:"10%","min-width":"120px"}},null,-1),Ct=n("col",{style:{width:"15%","min-width":"120px"}},null,-1),Mt={key:0,style:{width:"15%","min-width":"160px"}},Dt=n("col",{style:{width:"15%","min-width":"120px"}},null,-1),Vt={class:"bg-white border border-gray-200 border-solid"},jt={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-left text-gray-700 border-t border-b border-gray-200 border-solid"},qt={key:1,class:"pl-7"},Et={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-right text-gray-700 border-t border-b border-gray-200 border-solid"},Lt={key:1},At={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-left text-gray-700 border-t border-b border-gray-200 border-solid"},Ut={key:1},zt={key:0,class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-left text-gray-700 border-t border-b border-gray-200 border-solid"},Ot={key:1},Nt={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-right text-gray-700 border-t border-b border-gray-200 border-solid"},Ft={key:1,class:"pr-10 column-heading"},Ws={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},currency:{type:[Object,String,null],required:!0},isLoading:{type:Boolean,default:!1},itemValidationScope:{type:String,default:""}},setup(s){const t=s,e=te(),i=$(()=>t.currency?t.currency:e.selectedCompanyCurrency);return(T,w)=>{const I=x("BaseContentPlaceholdersText"),f=x("BaseContentPlaceholders"),V=x("BaseIcon");return l(),v(Q,null,[n("table",Tt,[n("colgroup",null,[kt,Pt,Ct,s.store[s.storeProp].discount_per_item==="YES"?(l(),v("col",Mt)):A("",!0),Dt]),n("thead",Vt,[n("tr",null,[n("th",jt,[s.isLoading?(l(),q(f,{key:0},{default:u(()=>[a(I,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("span",qt,b(T.$tc("items.item",2)),1))]),n("th",Et,[s.isLoading?(l(),q(f,{key:0},{default:u(()=>[a(I,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("span",Lt,b(T.$t("invoices.item.quantity")),1))]),n("th",At,[s.isLoading?(l(),q(f,{key:0},{default:u(()=>[a(I,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("span",Ut,b(T.$t("invoices.item.price")),1))]),s.store[s.storeProp].discount_per_item==="YES"?(l(),v("th",zt,[s.isLoading?(l(),q(f,{key:0},{default:u(()=>[a(I,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("span",Ot,b(T.$t("invoices.item.discount")),1))])):A("",!0),n("th",Nt,[s.isLoading?(l(),q(f,{key:0},{default:u(()=>[a(I,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("span",Ft,b(T.$t("invoices.item.amount")),1))])])]),a(o(qe),{modelValue:s.store[s.storeProp].items,"onUpdate:modelValue":w[0]||(w[0]=p=>s.store[s.storeProp].items=p),"item-key":"id",tag:"tbody",handle:".handle"},{item:u(({element:p,index:j})=>[a(St,{key:p.id,index:j,"item-data":p,loading:s.isLoading,currency:o(i),"item-validation-scope":s.itemValidationScope,"invoice-items":s.store[s.storeProp].items,store:s.store,"store-prop":s.storeProp},null,8,["index","item-data","loading","currency","item-validation-scope","invoice-items","store","store-prop"])]),_:1},8,["modelValue"])]),n("div",{class:"flex items-center justify-center w-full px-6 py-3 text-base border border-t-0 border-gray-200 border-solid cursor-pointer text-primary-400 hover:bg-primary-100",onClick:w[1]||(w[1]=(...p)=>s.store.addItem&&s.store.addItem(...p))},[a(V,{name:"PlusCircleIcon",class:"mr-2"}),L(" "+b(T.$t("general.add_new_item")),1)])],64)}}},Yt={class:"flex items-center justify-between w-full mt-2 text-sm"},Gt={class:"font-semibold leading-5 text-gray-500 uppercase"},Wt={class:"flex items-center justify-center text-lg text-black"},Rt={props:{index:{type:Number,required:!0},tax:{type:Object,required:!0},taxes:{type:Array,required:!0},currency:{type:[Object,String],required:!0},store:{type:Object,default:null},data:{type:String,default:""}},emits:["update","remove"],setup(s,{emit:t}){const e=s;re("$utils");const i=$(()=>e.tax.compound_tax&&e.store.getSubtotalWithDiscount?Math.round((e.store.getSubtotalWithDiscount+e.store.getTotalSimpleTax)*e.tax.percent/100):e.store.getSubtotalWithDiscount&&e.tax.percent?Math.round(e.store.getSubtotalWithDiscount*e.tax.percent/100):0);Ue(()=>{e.store.getSubtotalWithDiscount&&T(),e.store.getTotalSimpleTax&&T()});function T(){t("update",G(N({},e.tax),{amount:i.value}))}return(w,I)=>{const f=x("BaseFormatMoney"),V=x("BaseIcon");return l(),v("div",Yt,[n("label",Gt,b(s.tax.name)+" ("+b(s.tax.percent)+" %) ",1),n("label",Wt,[a(f,{amount:s.tax.amount,currency:s.currency},null,8,["amount","currency"]),a(V,{name:"TrashIcon",class:"h-5 ml-2 cursor-pointer",onClick:I[0]||(I[0]=p=>w.$emit("remove",s.tax.id))})])])}}},Xt={class:"w-full mt-4 tax-select"},Ht={class:"relative w-full max-w-md px-4"},Jt={class:"overflow-hidden rounded-md shadow-lg ring-1 ring-black ring-opacity-5"},Zt={class:"relative bg-white"},Kt={class:"relative p-4"},Qt={key:0,class:"relative flex flex-col overflow-auto list max-h-36 border-t border-gray-200"},es=["onClick"],ts={class:"flex justify-between px-2"},ss={class:"m-0 text-base font-semibold leading-tight text-gray-700 cursor-pointer"},os={class:"m-0 text-base font-semibold text-gray-700 cursor-pointer"},as={key:1,class:"flex justify-center p-5 text-gray-400"},ns={class:"text-base text-gray-500 cursor-pointer"},rs={class:"m-0 ml-3 text-sm leading-none cursor-pointer font-base text-primary-400"},ls={props:{type:{type:String,default:null},store:{type:Object,default:null},storeProp:{type:String,default:""}},emits:["select:taxType"],setup(s,{emit:t}){const e=s,i=J(),T=ee(),w=ae(),{t:I}=Z(),f=W(null),V=$(()=>f.value?T.taxTypes.filter(function(P){return P.name.toLowerCase().indexOf(f.value.toLowerCase())!==-1}):T.taxTypes),p=$(()=>e.store[e.storeProp].taxes);function j(P,d){t("select:taxType",N({},P)),d()}function D(){i.openModal({title:I("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:P=>t("select:taxType",P)})}return(P,d)=>{const r=x("BaseIcon"),m=x("BaseInput");return l(),v("div",Xt,[a(o(Fe),{class:"relative"},{default:u(({isOpen:c})=>[a(o(ze),{class:H([c?"":"text-opacity-90","flex items-center text-sm font-medium text-primary-400 focus:outline-none focus:border-none"])},{default:u(()=>[a(r,{name:"PlusIcon",class:"w-4 h-4 font-medium text-primary-400"}),L(" "+b(P.$t("settings.tax_types.add_tax")),1)]),_:2},1032,["class"]),n("div",Ht,[a(Oe,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:u(()=>[a(o(Ne),{style:{"min-width":"350px","margin-left":"62px",top:"-28px"},class:"absolute z-10 px-4 py-2 -translate-x-full sm:px-0"},{default:u(({close:k})=>[n("div",Jt,[n("div",Zt,[n("div",Kt,[a(m,{modelValue:f.value,"onUpdate:modelValue":d[0]||(d[0]=y=>f.value=y),placeholder:P.$t("general.search"),type:"text",class:"text-black"},null,8,["modelValue","placeholder"])]),o(V).length>0?(l(),v("div",Qt,[(l(!0),v(Q,null,se(o(V),(y,M)=>(l(),v("div",{key:M,class:H([{"bg-gray-100 cursor-not-allowed opacity-50 pointer-events-none":o(p).find(C=>C.tax_type_id===y.id)},"px-6 py-4 border-b border-gray-200 border-solid cursor-pointer hover:bg-gray-100 hover:cursor-pointer last:border-b-0"]),tabindex:"2",onClick:C=>j(y,k)},[n("div",ts,[n("label",ss,b(y.name),1),n("label",os,b(y.percent)+" % ",1)])],10,es))),128))])):(l(),v("div",as,[n("label",ns,b(P.$t("general.no_tax_found")),1)]))]),o(w).hasAbilities(o(ne).CREATE_TAX_TYPE)?(l(),v("button",{key:0,type:"button",class:"flex items-center justify-center w-full h-10 px-2 py-3 bg-gray-200 border-none outline-none",onClick:D},[a(r,{name:"CheckCircleIcon",class:"text-primary-400"}),n("label",rs,b(P.$t("estimates.add_new_tax")),1)])):A("",!0)])]),_:1})]),_:1})])]),_:1})])}}},is={class:"px-5 py-4 mt-6 bg-white border border-gray-200 border-solid rounded md:min-w-[390px] min-w-[300px] lg:mt-7"},ds={class:"flex items-center justify-between w-full"},cs={key:1,class:"text-sm font-semibold leading-5 text-gray-400 uppercase"},us={key:3,class:"flex items-center justify-center m-0 text-lg text-black uppercase"},ms={key:1,class:"m-0 text-sm font-semibold leading-5 text-gray-500 uppercase"},ps={key:3,class:"flex items-center justify-center m-0 text-lg text-black uppercase"},ys={key:0,class:"flex items-center justify-between w-full mt-2"},xs={key:1,class:"text-sm font-semibold leading-5 text-gray-400 uppercase"},fs={key:3,class:"flex",style:{width:"140px"},role:"group"},_s={class:"flex items-center"},gs={key:1},hs={class:"flex items-center justify-between w-full pt-2 mt-5 border-t border-gray-200 border-solid"},bs={key:1,class:"m-0 text-sm font-semibold leading-5 text-gray-400 uppercase"},vs={key:3,class:"flex items-center justify-center text-lg uppercase text-primary-400"},Rs={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},taxPopupType:{type:String,default:""},currency:{type:[Object,String],default:""},isLoading:{type:Boolean,default:!1}},setup(s){const t=s,e=W(null);re("$utils");const i=te(),T=$({get:()=>t.store[t.storeProp].discount,set:d=>{t.store[t.storeProp].discount_type==="percentage"?t.store[t.storeProp].discount_val=Math.round(t.store.getSubTotal*d/100):t.store[t.storeProp].discount_val=Math.round(d*100),t.store[t.storeProp].discount=d}}),w=$({get:()=>t.store[t.storeProp].taxes,set:d=>{t.store.$patch(r=>{r[t.storeProp].taxes=d})}}),I=$(()=>{let d=[];return t.store[t.storeProp].items.forEach(r=>{r.taxes&&r.taxes.forEach(m=>{let c=d.find(k=>k.tax_type_id===m.tax_type_id);c?c.amount+=m.amount:m.tax_type_id&&d.push({tax_type_id:m.tax_type_id,amount:m.amount,percent:m.percent,name:m.name})})}),d}),f=$(()=>t.currency?t.currency:i.selectedCompanyCurrency);function V(){t.store[t.storeProp].discount_type!=="fixed"&&(t.store[t.storeProp].discount_val=Math.round(t.store[t.storeProp].discount*100),t.store[t.storeProp].discount_type="fixed")}function p(){t.store[t.storeProp].discount_type!=="percentage"&&(t.store[t.storeProp].discount_val=t.store.getSubTotal*t.store[t.storeProp].discount/100,t.store[t.storeProp].discount_type="percentage")}function j(d){let r=0;d.compound_tax&&t.store.getSubtotalWithDiscount?r=Math.round((t.store.getSubtotalWithDiscount+t.store.getTotalSimpleTax)*d.percent/100):t.store.getSubtotalWithDiscount&&d.percent&&(r=Math.round(t.store.getSubtotalWithDiscount*d.percent/100));let m=G(N({},ne),{id:ge.raw(),name:d.name,percent:d.percent,compound_tax:d.compound_tax,tax_type_id:d.id,amount:r});t.store.$patch(c=>{c[t.storeProp].taxes.push(N({},m))})}function D(d){const r=t.store[t.storeProp].taxes.find(m=>m.id===d.id);r&&Object.assign(r,N({},d))}function P(d){const r=t.store[t.storeProp].taxes.findIndex(m=>m.id===d);t.store.$patch(m=>{m[t.storeProp].taxes.splice(r,1)})}return(d,r)=>{const m=x("BaseContentPlaceholdersText"),c=x("BaseContentPlaceholders"),k=x("BaseFormatMoney"),y=x("BaseInput"),M=x("BaseIcon"),C=x("BaseButton"),_=x("BaseDropdownItem"),h=x("BaseDropdown");return l(),v("div",is,[n("div",ds,[s.isLoading?(l(),q(c,{key:0},{default:u(()=>[a(m,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("label",cs,b(d.$t("estimates.sub_total")),1)),s.isLoading?(l(),q(c,{key:2},{default:u(()=>[a(m,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("label",us,[a(k,{amount:s.store.getSubTotal,currency:o(f)},null,8,["amount","currency"])]))]),(l(!0),v(Q,null,se(o(I),B=>(l(),v("div",{key:B.tax_type_id,class:"flex items-center justify-between w-full"},[s.isLoading?(l(),q(c,{key:0},{default:u(()=>[a(m,{lines:1,class:"w-16 h-5"})]),_:1})):s.store[s.storeProp].tax_per_item==="YES"?(l(),v("label",ms,b(B.name)+" - "+b(B.percent)+"% ",1)):A("",!0),s.isLoading?(l(),q(c,{key:2},{default:u(()=>[a(m,{lines:1,class:"w-16 h-5"})]),_:1})):s.store[s.storeProp].tax_per_item==="YES"?(l(),v("label",ps,[a(k,{amount:B.amount,currency:o(f)},null,8,["amount","currency"])])):A("",!0)]))),128)),s.store[s.storeProp].discount_per_item==="NO"||s.store[s.storeProp].discount_per_item===null?(l(),v("div",ys,[s.isLoading?(l(),q(c,{key:0},{default:u(()=>[a(m,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("label",xs,b(d.$t("estimates.discount")),1)),s.isLoading?(l(),q(c,{key:2},{default:u(()=>[a(m,{lines:1,class:"w-24 h-8 border rounded-md"})]),_:1})):(l(),v("div",fs,[a(y,{modelValue:o(T),"onUpdate:modelValue":r[0]||(r[0]=B=>K(T)?T.value=B:null),class:"border-r-0 focus:border-r-2 rounded-tr-sm rounded-br-sm h-[38px]"},null,8,["modelValue"]),a(h,{position:"bottom-end"},{activator:u(()=>[a(C,{class:"p-2 rounded-none rounded-tr-md rounded-br-md",type:"button",variant:"white"},{default:u(()=>[n("span",_s,[L(b(s.store[s.storeProp].discount_type=="fixed"?o(f).symbol:"%")+" ",1),a(M,{name:"ChevronDownIcon",class:"w-4 h-4 ml-1 text-gray-500"})])]),_:1})]),default:u(()=>[a(_,{onClick:V},{default:u(()=>[L(b(d.$t("general.fixed")),1)]),_:1}),a(_,{onClick:p},{default:u(()=>[L(b(d.$t("general.percentage")),1)]),_:1})]),_:1})]))])):A("",!0),s.store[s.storeProp].tax_per_item==="NO"||s.store[s.storeProp].tax_per_item===null?(l(),v("div",gs,[(l(!0),v(Q,null,se(o(w),(B,E)=>(l(),q(Rt,{key:B.id,index:E,tax:B,taxes:o(w),currency:s.currency,store:s.store,onRemove:P,onUpdate:D},null,8,["index","tax","taxes","currency","store"]))),128))])):A("",!0),s.store[s.storeProp].tax_per_item==="NO"||s.store[s.storeProp].tax_per_item===null?(l(),v("div",{key:2,ref:(B,E)=>{E.taxModal=B,e.value=B},class:"float-right pt-2 pb-4"},[a(ls,{"store-prop":s.storeProp,store:s.store,type:s.taxPopupType,"onSelect:taxType":j},null,8,["store-prop","store","type"])],512)):A("",!0),n("div",hs,[s.isLoading?(l(),q(c,{key:0},{default:u(()=>[a(m,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("label",bs,b(d.$t("estimates.total"))+" "+b(d.$t("estimates.amount"))+":",1)),s.isLoading?(l(),q(c,{key:2},{default:u(()=>[a(m,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("label",vs,[a(k,{amount:s.store.getTotal,currency:o(f)},null,8,["amount","currency"])]))])])}}},$s={class:"flex justify-between w-full"},ws={class:"px-8 py-8 sm:p-6"},Bs={key:0,class:"grid grid-cols-3 gap-2 p-1 overflow-x-auto"},Is=["onClick"],Ss=["src","alt"],Ts=["alt","src"],ks={key:1,class:"z-0 flex ml-3 pt-5"},Ps={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},Xs={setup(s){const t=J(),e=ae(),i=W(""),T=$(()=>t.active&&t.componentName==="SelectTemplate"),w=$(()=>t.title);function I(){t.data.store[t.data.storeProp].template_name?i.value=t.data.store[t.data.storeProp].template_name:i.value=t.data.templates[0]}async function f(){await t.data.store.setTemplate(i.value),!t.data.store.isEdit&&t.data.isMarkAsDefault&&(t.data.storeProp=="newEstimate"?await e.updateUserSettings({settings:{default_estimate_template:i.value}}):t.data.storeProp=="newInvoice"&&await e.updateUserSettings({settings:{default_invoice_template:i.value}})),p()}function V(){return new URL("/img/tick.png",self.location)}function p(){t.closeModal(),setTimeout(()=>{t.$reset()},300)}return(j,D)=>{const P=x("BaseIcon"),d=x("BaseCheckbox"),r=x("BaseButton"),m=x("BaseModal");return l(),q(m,{show:o(T),onClose:p,onOpen:I},{header:u(()=>[n("div",$s,[L(b(o(w))+" ",1),a(P,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:p})])]),default:u(()=>[n("div",ws,[o(t).data?(l(),v("div",Bs,[(l(!0),v(Q,null,se(o(t).data.templates,(c,k)=>(l(),v("div",{key:k,class:H([{"border border-solid border-primary-500":i.value===c.name},"relative flex flex-col m-2 border border-gray-200 border-solid cursor-pointer hover:border-primary-300"]),onClick:y=>i.value=c.name},[n("img",{src:c.path,alt:c.name,class:"w-full min-h-[100px]"},null,8,Ss),i.value===c.name?(l(),v("img",{key:0,alt:c.name,class:"absolute z-10 w-5 h-5 text-primary-500",style:{top:"-6px",right:"-5px"},src:V()},null,8,Ts)):A("",!0),n("span",{class:H(["w-full p-1 bg-gray-200 text-sm text-center absolute bottom-0 left-0",{"text-primary-500 bg-primary-100":i.value===c.name,"text-gray-600":i.value!=c.name}])},b(c.name),3)],10,Is))),128))])):A("",!0),o(t).data.store.isEdit?A("",!0):(l(),v("div",ks,[a(d,{modelValue:o(t).data.isMarkAsDefault,"onUpdate:modelValue":D[0]||(D[0]=c=>o(t).data.isMarkAsDefault=c),"set-initial-value":!1,variant:"primary",label:j.$t("general.mark_as_default"),description:o(t).data.markAsDefaultDescription},null,8,["modelValue","label","description"])]))]),n("div",Ps,[a(r,{class:"mr-3",variant:"primary-outline",onClick:p},{default:u(()=>[L(b(j.$t("general.cancel")),1)]),_:1}),a(r,{variant:"primary",onClick:D[1]||(D[1]=c=>f())},{left:u(c=>[a(P,{name:"SaveIcon",class:H(c.class)},null,8,["class"])]),default:u(()=>[L(" "+b(j.$t("general.choose")),1)]),_:1})])]),_:1},8,["show"])}}},Cs={class:"flex justify-between w-full"},Ms={class:"item-modal"},Ds=["onSubmit"],Vs={class:"px-8 py-8 sm:p-6"},js={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},Hs={emits:["newItem"],setup(s,{emit:t}){const e=J(),i=xe(),T=te(),w=ee();Me(),De();const{t:I}=Z(),f=W(!1),V=W(T.selectedCompanySettings.tax_per_item),p=$(()=>e.active&&e.componentName==="ItemModal"),j=$({get:()=>i.currentItem.price/100,set:y=>{i.currentItem.price=Math.round(y*100)}}),D=$({get:()=>i.currentItem.taxes.map(y=>{if(y)return G(N({},y),{tax_type_id:y.id,tax_name:y.name+" ("+y.percent+"%)"})}),set:y=>{i.$patch(M=>{M.currentItem.taxes=y})}}),P=$(()=>V.value==="YES"),d={name:{required:z.withMessage(I("validation.required"),R),minLength:z.withMessage(I("validation.name_min_length",{count:3}),Ye(3))},description:{maxLength:z.withMessage(I("validation.description_maxlength",{count:255}),oe(255))}},r=ie(d,$(()=>i.currentItem)),m=$(()=>w.taxTypes.map(y=>G(N({},y),{tax_name:y.name+" ("+y.percent+"%)"})));he(()=>{r.value.$reset(),i.fetchItemUnits({limit:"all"})});async function c(){if(r.value.$touch(),r.value.$invalid)return!0;let y=G(N({},i.currentItem),{taxes:i.currentItem.taxes.map(C=>({tax_type_id:C.id,amount:j.value*C.percent/100,percent:C.percent,name:C.name,collective_tax:0}))});f.value=!0,await(i.isEdit?i.updateItem:i.addItem)(y).then(C=>{f.value=!1,C.data.data&&e.data&&e.refreshData(C.data.data),k()})}function k(){e.closeModal(),setTimeout(()=>{i.resetCurrentItem(),e.$reset(),r.value.$reset()},300)}return(y,M)=>{const C=x("BaseIcon"),_=x("BaseInput"),h=x("BaseInputGroup"),B=x("BaseMoney"),E=x("BaseMultiselect"),g=x("BaseTextarea"),S=x("BaseInputGrid"),U=x("BaseButton"),Y=x("BaseModal");return l(),q(Y,{show:o(p),onClose:k},{header:u(()=>[n("div",Cs,[L(b(o(e).title)+" ",1),a(C,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:k})])]),default:u(()=>[n("div",Ms,[n("form",{action:"",onSubmit:be(c,["prevent"])},[n("div",Vs,[a(S,{layout:"one-column"},{default:u(()=>[a(h,{label:y.$t("items.name"),required:"",error:o(r).name.$error&&o(r).name.$errors[0].$message},{default:u(()=>[a(_,{modelValue:o(i).currentItem.name,"onUpdate:modelValue":M[0]||(M[0]=O=>o(i).currentItem.name=O),type:"text",invalid:o(r).name.$error,onInput:M[1]||(M[1]=O=>o(r).name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(h,{label:y.$t("items.price")},{default:u(()=>[a(B,{key:o(T).selectedCompanyCurrency,modelValue:o(j),"onUpdate:modelValue":M[2]||(M[2]=O=>K(j)?j.value=O:null),currency:o(T).selectedCompanyCurrency,class:"relative w-full focus:border focus:border-solid focus:border-primary"},null,8,["modelValue","currency"])]),_:1},8,["label"]),a(h,{label:y.$t("items.unit")},{default:u(()=>[a(E,{modelValue:o(i).currentItem.unit_id,"onUpdate:modelValue":M[3]||(M[3]=O=>o(i).currentItem.unit_id=O),label:"name",options:o(i).itemUnits,"value-prop":"id","can-deselect":!1,"can-clear":!1,placeholder:y.$t("items.select_a_unit"),searchable:"","track-by":"name"},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),o(P)?(l(),q(h,{key:0,label:y.$t("items.taxes")},{default:u(()=>[a(E,{modelValue:o(D),"onUpdate:modelValue":M[4]||(M[4]=O=>K(D)?D.value=O:null),options:o(m),mode:"tags",label:"tax_name","value-prop":"id",class:"w-full","can-deselect":!1,"can-clear":!1,searchable:"","track-by":"tax_name",object:""},null,8,["modelValue","options"])]),_:1},8,["label"])):A("",!0),a(h,{label:y.$t("items.description"),error:o(r).description.$error&&o(r).description.$errors[0].$message},{default:u(()=>[a(g,{modelValue:o(i).currentItem.description,"onUpdate:modelValue":M[5]||(M[5]=O=>o(i).currentItem.description=O),rows:"4",cols:"50",invalid:o(r).description.$error,onInput:M[6]||(M[6]=O=>o(r).description.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1})]),n("div",js,[a(U,{class:"mr-3",variant:"primary-outline",type:"button",onClick:k},{default:u(()=>[L(b(y.$t("general.cancel")),1)]),_:1}),a(U,{loading:f.value,disabled:f.value,variant:"primary",type:"submit"},{left:u(O=>[a(C,{name:"SaveIcon",class:H(O.class)},null,8,["class"])]),default:u(()=>[L(" "+b(o(i).isEdit?y.$t("general.update"):y.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],40,Ds)])]),_:1},8,["show"])}}},qs={class:"flex justify-between w-full"},Es={class:"flex flex-col"},Ls={class:"text-sm text-gray-500 mt-1"},As=["onSubmit"],Us={class:"p-4 sm:p-6"},zs={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},Os={emits:["addTax"],setup(s,{emit:t}){const e=J();Ve();const i=fe({state:"",city:"",address_street_1:"",zip:""}),T=W(!1),w=ee(),{t:I}=Z(),f=$(()=>e.active&&e.componentName==="TaxationAddressModal"),V=$(()=>({state:{required:z.withMessage(I("validation.required"),R)},city:{required:z.withMessage(I("validation.required"),R)},address_street_1:{required:z.withMessage(I("validation.required"),R)},zip:{required:z.withMessage(I("validation.required"),R)}})),p=ie(V,$(()=>i));async function j(){if(p.value.$touch(),p.value.$invalid)return!0;let d={address:i};e.id&&(d.customer_id=e.id),i.address_street_1=i.address_street_1.replace(/(\r\n|\n|\r)/gm,""),T.value=!0,await w.fetchSalesTax(d).then(r=>{T.value=!1,t("addTax",r.data.data),P()}).catch(r=>{T.value=!1})}function D(){var d,r,m,c;i.state=(d=e==null?void 0:e.data)==null?void 0:d.state,i.city=(r=e==null?void 0:e.data)==null?void 0:r.city,i.address_street_1=(m=e==null?void 0:e.data)==null?void 0:m.address_street_1,i.zip=(c=e==null?void 0:e.data)==null?void 0:c.zip}function P(){e.closeModal()}return(d,r)=>{const m=x("BaseIcon"),c=x("BaseInput"),k=x("BaseInputGroup"),y=x("BaseTextarea"),M=x("BaseInputGrid"),C=x("BaseButton"),_=x("BaseModal");return l(),q(_,{show:o(f),onClose:P,onOpen:D},{header:u(()=>[n("div",qs,[n("div",Es,[L(b(o(e).title)+" ",1),n("p",Ls,b(o(e).content),1)]),a(m,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:P})])]),default:u(()=>[n("form",{onSubmit:be(j,["prevent"])},[n("div",Us,[a(M,{layout:"one-column"},{default:u(()=>[a(k,{required:"",error:o(p).state.$error&&o(p).state.$errors[0].$message,label:d.$t("customers.state")},{default:u(()=>[a(c,{modelValue:o(i).state,"onUpdate:modelValue":r[0]||(r[0]=h=>o(i).state=h),type:"text",name:"shippingState",class:"mt-1 md:mt-0",invalid:o(p).state.$error,onInput:r[1]||(r[1]=h=>o(p).state.$touch()),placeholder:d.$t("settings.taxations.state_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"]),a(k,{required:"",error:o(p).city.$error&&o(p).city.$errors[0].$message,label:d.$t("customers.city")},{default:u(()=>[a(c,{modelValue:o(i).city,"onUpdate:modelValue":r[2]||(r[2]=h=>o(i).city=h),type:"text",name:"shippingCity",class:"mt-1 md:mt-0",invalid:o(p).city.$error,onInput:r[3]||(r[3]=h=>o(p).city.$touch()),placeholder:d.$t("settings.taxations.city_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"]),a(k,{required:"",error:o(p).address_street_1.$error&&o(p).address_street_1.$errors[0].$message,label:d.$t("customers.address")},{default:u(()=>[a(y,{modelValue:o(i).address_street_1,"onUpdate:modelValue":r[4]||(r[4]=h=>o(i).address_street_1=h),rows:"2",cols:"50",class:"mt-1 md:mt-0",invalid:o(p).address_street_1.$error,onInput:r[5]||(r[5]=h=>o(p).address_street_1.$touch()),placeholder:d.$t("settings.taxations.address_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"]),a(k,{required:"",error:o(p).zip.$error&&o(p).zip.$errors[0].$message,label:d.$t("customers.zip_code")},{default:u(()=>[a(c,{modelValue:o(i).zip,"onUpdate:modelValue":r[6]||(r[6]=h=>o(i).zip=h),invalid:o(p).zip.$error,onInput:r[7]||(r[7]=h=>o(p).zip.$touch()),type:"text",class:"mt-1 md:mt-0",placeholder:d.$t("settings.taxations.zip_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"])]),_:1})]),n("div",zs,[a(C,{class:"mr-3 text-sm",type:"button",variant:"primary-outline",onClick:P},{default:u(()=>[L(b(d.$t("general.cancel")),1)]),_:1}),a(C,{loading:T.value,variant:"primary",type:"submit"},{left:u(h=>[T.value?A("",!0):(l(),q(m,{key:0,name:"SaveIcon",class:H(h.class)},null,8,["class"]))]),default:u(()=>[L(" "+b(d.$t("general.save")),1)]),_:1},8,["loading"])])],40,As)]),_:1},8,["show"])}}},Js={props:{isEdit:{type:Boolean,default:null},type:{type:String,default:null},customer:{type:[Object],default:null},store:{type:Object,default:null},storeProp:{type:String,default:null}},setup(s){const t=s,e="Sales Tax",i="MODULE",T=J(),w=te(),I=ee(),{t:f}=Z(),V=W(!1),p=$(()=>t.isEdit?t.store[t.storeProp].sales_tax_address_type==="billing":w.selectedCompanySettings.sales_tax_address_type==="billing"),j=$(()=>w.selectedCompanySettings.sales_tax_us_enabled==="YES"),D=$(()=>t.isEdit?t.store[t.storeProp].sales_tax_type==="customer_level":w.selectedCompanySettings.sales_tax_type==="customer_level"),P=$(()=>t.isEdit?t.store[t.storeProp].sales_tax_type==="company_level":w.selectedCompanySettings.sales_tax_type==="company_level"),d=$(()=>{if(D.value&&r.value){let _=p.value?t.customer.billing:t.customer.shipping;return{address:X.exports.pick(_,["address_street_1","city","state","zip"]),customer_id:t.customer.id}}else if(P.value&&r.value)return{address:X.exports.pick(address,["address_street_1","city","state","zip"])}}),r=$(()=>{var _,h;if(D.value){let B=p.value?(_=t.customer)==null?void 0:_.billing:(h=t.customer)==null?void 0:h.shipping;return m(B)}else if(P.value)return m(w.selectedCompany.address);return!1});le(()=>t.customer,(_,h)=>{if(_&&h&&D.value){c(_,h);return}!r.value&&D.value&&_?setTimeout(()=>{k()},500):D.value&&_?y():D.value&&!_&&C()}),he(()=>{P.value&&(r.value?y():k())});function m(_){return _?_.address_street_1&&_.city&&_.state&&_.zip:!1}function c(_,h){const B=p.value?_.billing:_.shipping,E=p.value?h.billing:h.shipping,g=X.exports.pick(B,["address_street_1","city","state","zip"]),S=X.exports.pick(E,["address_street_1","city","state","zip"]);X.exports.isEqual(g,S)||y()}function k(){var B,E;if(!j.value)return;let _=null,h="";D.value?p.value?(_=(B=t.customer)==null?void 0:B.billing,h=f("settings.taxations.add_billing_address")):(_=(E=t.customer)==null?void 0:E.shipping,h=f("settings.taxations.add_shipping_address")):(_=w.selectedCompany.address,h=f("settings.taxations.add_company_address")),T.openModal({title:h,content:f("settings.taxations.modal_description"),componentName:"TaxationAddressModal",data:_,id:D.value?t.customer.id:""})}async function y(){!j.value||(V.value=!0,await I.fetchSalesTax(d.value).then(_=>{M(_.data.data),V.value=!1}).catch(_=>{_.response.data.error&&setTimeout(()=>{k()},500),V.value=!1}))}function M(_){_.tax_type_id=_.id;const h=t.store[t.storeProp].taxes.findIndex(B=>B.name===e&&B.type===i);h>-1?Object.assign(t.store[t.storeProp].taxes[h],_):t.store[t.storeProp].taxes.push(_)}function C(){const _=t.store[t.storeProp].taxes.findIndex(B=>B.name===e&&B.type===i);_>-1&&t.store[t.storeProp].taxes.splice(_,1);let h=I.taxTypes.findIndex(B=>B.name===e&&B.type===i);h>-1&&I.taxTypes.splice(h,1)}return(_,h)=>(l(),q(Os,{onAddTax:M}))}};export{Xs as _,Hs as a,Js as b,Ws as c,Rs as d};
