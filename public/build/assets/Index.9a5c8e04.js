import{a8 as H,u as L,l as M,N as G,M as ne,m as O,a3 as oe,r as n,o as f,j as _,h as e,x as o,a as t,z as y,t as d,d as v,K as re,e as D,E as ue,f as ie,ae as ce,b as g,a9 as E,aa as T,n as x,Q as de,g as z,a4 as me}from"./main.39f33818.js";import{u as W}from"./users.8c68be41.js";import{_ as pe}from"./AstronautIcon.76566b81.js";const fe={__name:"UserIndexDropdown",props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(I){const U=I,u=H();L();const{t:m}=M();G();const B=ne();O();const b=W();oe("utils");function p(i){u.openDialog({title:m("general.are_you_sure"),message:m("users.confirm_delete",1),yesLabel:m("general.ok"),noLabel:m("general.cancel"),variant:"danger",size:"lg",hideNoButton:!1}).then(l=>{l&&b.deleteUser({ids:[i]}).then(h=>{h&&U.loadData&&U.loadData()})})}return(i,l)=>{const h=n("BaseIcon"),$=n("BaseButton"),k=n("BaseDropdownItem"),C=n("router-link"),V=n("BaseDropdown");return f(),_(V,null,{activator:e(()=>[o(B).name==="users.view"?(f(),_($,{key:0,variant:"primary"},{default:e(()=>[t(h,{name:"DotsHorizontalIcon",class:"h-5 text-white"})]),_:1})):(f(),_(h,{key:1,name:"DotsHorizontalIcon",class:"h-5 text-gray-500"}))]),default:e(()=>[t(C,{to:`/admin/users/${I.row.id}/edit`},{default:e(()=>[t(k,null,{default:e(()=>[t(h,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),y(" "+d(i.$t("general.edit")),1)]),_:1})]),_:1},8,["to"]),t(k,{onClick:l[0]||(l[0]=S=>p(I.row.id))},{default:e(()=>[t(h,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),y(" "+d(i.$t("general.delete")),1)]),_:1})]),_:1})}}},_e={class:"flex items-center justify-end space-x-5"},he={class:"relative table-container"},ge={class:"relative flex items-center justify-end h-5 border-gray-200 border-solid"},ye={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Be={class:"absolute z-10 items-center left-6 top-2.5 select-none"},ve={class:"custom-control custom-checkbox"},Ie={__name:"Index",setup(I){L();const U=H(),u=W(),m=G();O();let B=v(!1),b=v(!0);v(null),v("created_at"),v(!1);const{t:p}=M();let i=v(null),l=re({name:"",email:"",phone:""});const h=D(()=>[{key:"status",thClass:"extra",tdClass:"font-medium text-gray-900",sortable:!1},{key:"name",label:p("users.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"email",label:"Email"},{key:"phone",label:p("users.phone")},{key:"created_at",label:p("users.added_on")},{key:"actions",tdClass:"text-right text-sm font-medium",sortable:!1}]),$=D(()=>!u.totalUsers&&!b.value),k=D({get:()=>u.selectedUsers,set:s=>u.selectUser(s)}),C=D({get:()=>u.selectAllField,set:s=>u.setSelectAllState(s)});ue(l,()=>{V()},{deep:!0}),ie(()=>{u.fetchUsers(),u.fetchRoles()}),ce(()=>{u.selectAllField&&u.selectAllUsers()});function V(){S()}function S(){i.value&&i.value.refresh()}async function K({page:s,filter:r,sort:w}){let F={display_name:l.name!==null?l.name:"",phone:l.phone!==null?l.phone:"",email:l.email!==null?l.email:"",orderByField:w.fieldName||"created_at",orderBy:w.order||"desc",page:s};b.value=!0;let c=await u.fetchUsers(F);return b.value=!1,{data:c.data.data,pagination:{totalPages:c.data.meta.last_page,currentPage:s,totalCount:c.data.meta.total,limit:10}}}function j(){l.name="",l.email="",l.phone=null}function Q(){B.value&&j(),B.value=!B.value}function X(){U.openDialog({title:p("general.are_you_sure"),message:p("users.confirm_delete",2),yesLabel:p("general.ok"),noLabel:p("general.cancel"),variant:"danger",size:"lg",hideNoButton:!1}).then(s=>{s&&u.deleteMultipleUsers().then(r=>{r.data.success&&i.value&&i.value.refresh()})})}return(s,r)=>{const w=n("BaseBreadcrumbItem"),F=n("BaseBreadcrumb"),c=n("BaseIcon"),P=n("BaseButton"),q=n("BasePageHeader"),N=n("BaseInput"),A=n("BaseInputGroup"),J=n("BaseFilterWrapper"),Y=n("BaseEmptyPlaceholder"),Z=n("BaseDropdownItem"),ee=n("BaseDropdown"),R=n("BaseCheckbox"),te=n("router-link"),ae=n("BaseTable"),se=n("BasePage");return f(),_(se,null,{default:e(()=>[t(q,{title:s.$t("users.title")},{actions:e(()=>[g("div",_e,[E(t(P,{variant:"primary-outline",onClick:Q},{right:e(a=>[o(B)?(f(),_(c,{key:1,name:"XIcon",class:x(a.class)},null,8,["class"])):(f(),_(c,{key:0,name:"FilterIcon",class:x(a.class)},null,8,["class"]))]),default:e(()=>[y(d(s.$t("general.filter"))+" ",1)]),_:1},512),[[T,o(u).totalUsers]]),o(m).currentUser.is_owner||o(m).hasAbilities([o(de).CREATE_USER])?(f(),_(P,{key:0,onClick:r[0]||(r[0]=a=>s.$router.push("users/create"))},{left:e(a=>[t(c,{name:"PlusIcon",class:x(a.class),"aria-hidden":"true"},null,8,["class"])]),default:e(()=>[y(" "+d(s.$t("users.add_user")),1)]),_:1})):z("",!0)])]),default:e(()=>[t(F,null,{default:e(()=>[t(w,{title:s.$t("general.home"),to:"dashboard"},null,8,["title"]),t(w,{title:s.$tc("users.title",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),t(J,{show:o(B),class:"mt-3",onClear:j},{default:e(()=>[t(A,{label:s.$tc("users.name"),class:"flex-1 mt-2 mr-4"},{default:e(()=>[t(N,{modelValue:o(l).name,"onUpdate:modelValue":r[1]||(r[1]=a=>o(l).name=a),type:"text",name:"name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(A,{label:s.$tc("users.email"),class:"flex-1 mt-2 mr-4"},{default:e(()=>[t(N,{modelValue:o(l).email,"onUpdate:modelValue":r[2]||(r[2]=a=>o(l).email=a),type:"text",name:"email",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),t(A,{class:"flex-1 mt-2",label:s.$tc("users.phone")},{default:e(()=>[t(N,{modelValue:o(l).phone,"onUpdate:modelValue":r[3]||(r[3]=a=>o(l).phone=a),type:"text",name:"phone",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["show"]),E(t(Y,{title:s.$t("users.no_users"),description:s.$t("users.list_of_users")},{actions:e(()=>[o(m).currentUser.is_owner?(f(),_(P,{key:0,variant:"primary-outline",onClick:r[4]||(r[4]=a=>s.$router.push("/admin/users/create"))},{left:e(a=>[t(c,{name:"PlusIcon",class:x(a.class)},null,8,["class"])]),default:e(()=>[y(" "+d(s.$t("users.add_user")),1)]),_:1})):z("",!0)]),default:e(()=>[t(pe,{class:"mt-5 mb-4"})]),_:1},8,["title","description"]),[[T,$.value]]),E(g("div",he,[g("div",ge,[o(u).selectedUsers.length?(f(),_(ee,{key:0},{activator:e(()=>[g("span",ye,[y(d(s.$t("general.actions"))+" ",1),t(c,{name:"ChevronDownIcon",class:"h-5"})])]),default:e(()=>[t(Z,{onClick:X},{default:e(()=>[t(c,{name:"TrashIcon",class:"h-5 mr-3 text-gray-600"}),y(" "+d(s.$t("general.delete")),1)]),_:1})]),_:1})):z("",!0)]),t(ae,{ref_key:"table",ref:i,data:K,columns:h.value,class:"mt-3"},me({header:e(()=>[g("div",Be,[t(R,{modelValue:C.value,"onUpdate:modelValue":r[5]||(r[5]=a=>C.value=a),variant:"primary",onChange:o(u).selectAllUsers},null,8,["modelValue","onChange"])])]),"cell-status":e(({row:a})=>[g("div",ve,[t(R,{id:a.data.id,modelValue:k.value,"onUpdate:modelValue":r[6]||(r[6]=le=>k.value=le),value:a.data.id,variant:"primary"},null,8,["id","modelValue","value"])])]),"cell-name":e(({row:a})=>[t(te,{to:{path:`users/${a.data.id}/edit`},class:"font-medium text-primary-500"},{default:e(()=>[y(d(a.data.name),1)]),_:2},1032,["to"])]),"cell-phone":e(({row:a})=>[g("span",null,d(a.data.phone?a.data.phone:"-"),1)]),"cell-created_at":e(({row:a})=>[g("span",null,d(a.data.formatted_created_at),1)]),_:2},[o(m).currentUser.is_owner?{name:"cell-actions",fn:e(({row:a})=>[t(fe,{row:a.data,table:o(i),"load-data":S},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns"])],512),[[T,!$.value]])]),_:1})}}};export{Ie as default};
