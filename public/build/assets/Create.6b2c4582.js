import{ac as Q,ag as W,J as X,H as Y,l as Z,m as ee,M as te,d as _,e as p,v as se,r as l,o as b,j as S,h as u,b as m,a,n as ae,z as re,t as w,x as e,g as q,c as oe,w as ne,p as r,q as $,L as f,ah as V,s as le,a0 as ie,ai as ue,aj as C}from"./main.da672026.js";import{u as ce}from"./users.34183d9a.js";import{_ as de}from"./CreateCustomFields.d83e0913.js";const me={class:"flex items-center justify-end"},ge={class:"grid grid-cols-5 gap-4 mb-8"},_e={class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},pe={class:"grid grid-cols-5 gap-2 mb-8"},ve={key:0,class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},he={class:"col-span-5 lg:col-span-4"},x="customFields",we={__name:"Create",setup(fe){const t=Q(),M=W(),L=X(),F=Y(),k=ce(),{t:s}=Z(),D=ee(),G=te();let d=_(!1);_(!1),_(!1),_(!1);const v=_(!1),g=p(()=>G.name==="customers.edit");let P=p(()=>t.isFetchingInitialSettings);const y=p(()=>g.value?s("customers.edit_customer"):s("customers.new_customer")),U=p(()=>({currentCustomer:{name:{required:r.withMessage(s("validation.required"),$),minLength:r.withMessage(s("validation.name_min_length",{count:3}),f(3))},rfc:{required:r.withMessage(s("validation.required"),$),minLength:r.withMessage(s("validation.name_min_length",{count:3}),f(3))},prefix:{minLength:r.withMessage(s("validation.name_min_length",{count:3}),f(3))},currency_id:{required:r.withMessage(s("validation.required"),$)},email:{required:r.withMessage(s("validation.required"),V(t.currentCustomer.enable_portal==!0)),email:r.withMessage(s("validation.email_incorrect"),le)},password:{required:r.withMessage(s("validation.required"),V(t.currentCustomer.enable_portal==!0&&!t.currentCustomer.password_added)),minLength:r.withMessage(s("validation.password_min_length",{count:8}),f(8))},confirm_password:{sameAsPassword:r.withMessage(s("validation.password_incorrect"),ie(t.currentCustomer.password))},website:{url:r.withMessage(s("validation.invalid_url"),ue)},billing:{address_street_1:{maxLength:r.withMessage(s("validation.address_maxlength",{count:255}),C(255))},address_street_2:{maxLength:r.withMessage(s("validation.address_maxlength",{count:255}),C(255))}},shipping:{address_street_1:{maxLength:r.withMessage(s("validation.address_maxlength",{count:255}),C(255))},address_street_2:{maxLength:r.withMessage(s("validation.address_maxlength",{count:255}),C(255))}}}}));p(()=>`${window.location.origin}/${F.selectedCompany.slug}/customer/login`);const o=se(U,t,{$scope:x});t.resetCurrentCustomer(),t.fetchCustomerInitialSettings(g.value),k.fetchUsers();async function N(){if(o.value.$touch(),o.value.$invalid)return!0;v.value=!0;let i={...t.currentCustomer},n=null;try{n=await(g.value?t.updateCustomer:t.addCustomer)(i)}catch{v.value=!1;return}D.push(`/admin/customers/${n.data.data.id}/view`)}return(i,n)=>{const h=l("BaseBreadcrumbItem"),R=l("BaseBreadcrumb-item"),j=l("BaseBreadcrumb"),H=l("BaseIcon"),z=l("BaseButton"),A=l("BasePageHeader"),I=l("BaseInput"),B=l("BaseInputGroup"),E=l("BaseMultiselect"),T=l("BaseInputGrid"),J=l("BaseDivider"),K=l("BaseCard"),O=l("BasePage");return b(),S(O,null,{default:u(()=>[m("form",{onSubmit:ne(N,["prevent"])},[a(A,{title:y.value},{actions:u(()=>[m("div",me,[a(z,{type:"submit",loading:v.value,disabled:v.value},{left:u(c=>[a(H,{name:"SaveIcon",class:ae(c.class)},null,8,["class"])]),default:u(()=>[re(" "+w(g.value?i.$t("customers.update_customer"):i.$t("customers.save_customer")),1)]),_:1},8,["loading","disabled"])])]),default:u(()=>[a(j,null,{default:u(()=>[a(h,{title:i.$t("general.home"),to:"dashboard"},null,8,["title"]),a(h,{title:i.$tc("customers.customer",2),to:"/admin/customers"},null,8,["title"]),a(R,{title:y.value,to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),a(K,{class:"mt-5"},{default:u(()=>[m("div",ge,[m("h6",_e,w(i.$t("customers.basic_info")),1),a(T,{class:"col-span-5 lg:col-span-4"},{default:u(()=>[a(B,{label:i.$t("customers.rfc"),required:"",error:e(o).currentCustomer.rfc.$error&&e(o).currentCustomer.rfc.$errors[0].$message,"content-loading":e(d)},{default:u(()=>[a(I,{modelValue:e(t).currentCustomer.rfc,"onUpdate:modelValue":n[0]||(n[0]=c=>e(t).currentCustomer.rfc=c),"content-loading":e(d),type:"text",name:"name",class:"",invalid:e(o).currentCustomer.rfc.$error,onInput:n[1]||(n[1]=c=>e(o).currentCustomer.rfc.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","error","content-loading"]),a(B,{label:i.$t("customers.legal_name"),required:"",error:e(o).currentCustomer.name.$error&&e(o).currentCustomer.name.$errors[0].$message,"content-loading":e(d)},{default:u(()=>[a(I,{modelValue:e(t).currentCustomer.name,"onUpdate:modelValue":n[2]||(n[2]=c=>e(t).currentCustomer.name=c),"content-loading":e(d),type:"text",name:"name",class:"",invalid:e(o).currentCustomer.name.$error,onInput:n[3]||(n[3]=c=>e(o).currentCustomer.name.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","error","content-loading"]),a(B,{label:"Regimen Fiscal","content-loading":e(d),error:e(o).currentCustomer.currency_id.$error&&e(o).currentCustomer.currency_id.$errors[0].$message,required:""},{default:u(()=>[a(E,{modelValue:e(t).currentCustomer.sat_regime_id,"onUpdate:modelValue":n[4]||(n[4]=c=>e(t).currentCustomer.sat_regime_id=c),"value-prop":"id",label:"name","track-by":"name","content-loading":e(d),options:e(L).satRegimes,searchable:"","can-deselect":!1,placeholder:i.$t("customers.select_currency"),invalid:e(o).currentCustomer.currency_id.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["content-loading","error"])]),_:1})]),e(M).customFields.length>0?(b(),S(J,{key:0,class:"mb-5 md:mb-8"})):q("",!0),m("div",pe,[e(M).customFields.length>0?(b(),oe("h6",ve,w(i.$t("settings.custom_fields.title")),1)):q("",!0),m("div",he,[a(de,{type:"Customer",store:e(t),"store-prop":"currentCustomer","is-edit":g.value,"is-loading":e(P),"custom-field-scope":x},null,8,["store","is-edit","is-loading"])])])]),_:1})],32)]),_:1})}}};export{we as default};
