import{_ as W,d as l,r as v,o as S,c as M,b as t,w as K,a as f,n as O,$ as Q,I as J,ab as X,a8 as Y,N as ee,l as te,M as ae,m as se,K as le,e as u,E as ie,an as oe,j as F,h as o,x as N,Q as re,z as m,t as p,g as j,F as ne}from"./main.941df516.js";import{_ as de}from"./EstimateIndexDropdown.be635956.js";const ce={name:"EstimateItemDetail",props:["estimateItemDetailOpen","estimate"],emits:["close-estimateitemdetail"],setup(T,{emit:g}){const d=l(null),h=l(null);return{panelContent:d,closeBtn:h}}},ue={class:"sticky top-16 bg-gradient-to-b from-gray-100 to-white dark:from-[#151D2C] dark:to-gray-900 overflow-x-hidden overflow-y-auto no-scrollbar shrink-0 border-l border-gray-200 dark:border-gray-700/60 w-full sm:w-[calc(100dvw/2-128px)] h-[calc(100dvh-64px)]"},me=t("svg",{class:"fill-gray-400 group-hover:fill-gray-600 pointer-events-none",width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"m7.95 6.536 4.242-4.243a1 1 0 1 1 1.415 1.414L9.364 7.95l4.243 4.242a1 1 0 1 1-1.415 1.415L7.95 9.364l-4.243 4.243a1 1 0 0 1-1.414-1.415L6.536 7.95 2.293 3.707a1 1 0 0 1 1.414-1.414L7.95 6.536Z"})],-1),pe=[me],ve={class:"py-8 px-4 lg:px-8"},fe={class:"max-w-sm mx-auto lg:max-w-none"},ge=Q('<div class="text-gray-800 dark:text-gray-100 font-semibold text-center mb-1">Nombre del cliente</div><div class="text-sm text-center italic">Nombre del Agente</div><div class="drop-shadow-md mt-5"><div class="bg-white dark:bg-gray-800 rounded-t-xl px-5 pb-2.5 text-center pt-5"><div class="text-2xl font-semibold text-green-500 mb-1">$2,179.36</div><div class="text-sm font-medium text-gray-800 dark:text-gray-100 mb-3">Gasolina</div><div class="text-xs inline-flex font-medium bg-gray-400/20 text-gray-500 dark:text-gray-400 rounded-full text-center px-2.5 py-1">Status</div></div><div class="flex justify-between items-center" aria-hidden="true"><svg class="fill-white dark:fill-gray-800" width="20" height="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 20c5.523 0 10-4.477 10-10S5.523 0 0 0h20v20H0Z"></path></svg><div class="grow w-full h-5 bg-white dark:bg-gray-800 flex flex-col justify-center"><div class="h-px w-full border-t border-dashed border-gray-200 dark:border-gray-700"></div></div><svg class="fill-white dark:fill-gray-800 rotate-180" width="20" height="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 20c5.523 0 10-4.477 10-10S5.523 0 0 0h20v20H0Z"></path></svg></div><div class="bg-white dark:bg-gray-800 rounded-b-xl p-5 pt-2.5 text-sm space-y-3"><div class="flex justify-between space-x-1"><span class="italic">Partida:</span><span class="font-medium text-gray-700 dark:text-gray-100 text-right">1</span></div><div class="flex justify-between space-x-1"><span class="italic">Producto:</span><span class="font-medium text-gray-700 dark:text-gray-100 text-right">Gasolina</span></div><div class="flex justify-between space-x-1"><span class="italic">Litros:</span><span class="font-medium text-gray-700 dark:text-gray-100 text-right">1,000</span></div><div class="flex justify-between space-x-1"><span class="italic">Precio Unitario:</span><span class="font-medium text-gray-700 dark:text-gray-100 text-right">$17.803465</span></div></div></div>',3),xe={class:"mt-6"},he=t("div",{class:"text-sm font-semibold text-gray-800 dark:text-gray-100 mb-2"},"Archivos de Previa",-1),ye=t("div",{class:"mt-6"},[t("div",{class:"text-sm font-semibold text-gray-800 dark:text-gray-100 mb-2"},"Comentarios"),t("form",null,[t("label",{class:"sr-only",for:"notes"},"Write a note"),t("textarea",{id:"notes",class:"form-textarea w-full focus:border-gray-300",rows:"4",placeholder:"Write a note\u2026"})])],-1);function _e(T,g,d,h,y,a){const c=v("BaseFileUploader");return S(),M("div",{ref:"panelContent",class:O(["absolute inset-0 sm:left-auto z-20 shadow-xl transition-transform duration-200 ease-in-out",d.estimateItemDetailOpen?"translate-x-0":"translate-x-full"])},[t("div",ue,[t("button",{ref:"closeBtn",onClick:g[0]||(g[0]=K(_=>T.$emit("close-estimateitemdetail"),["stop"])),class:"absolute top-0 right-0 mt-6 mr-6 group p-2"},pe,512),t("div",ve,[t("div",fe,[ge,t("div",xe,[he,f(c)]),ye])])])],2)}var be=W(ce,[["render",_e]]);const we={class:"relative table-container pt-5"},Ee={__name:"View",setup(T){const g=J(),d=X();Y();const h=ee(),{t:y}=te(),a=l(null),c=ae();se(),l(!1);const _=l(!1),b=l(!1),r=l(null),x=l(1),I=l(1),V=l(null),w=l(!1),s=le({orderBy:null,orderByField:null,searchText:null}),H=u(()=>[{key:"id",label:"Partida"},{key:"name",label:"Producto"},{key:"quantity",label:"Litros"},{key:"precision_price",label:"Precio Unitario"},{key:"total",label:"Total"}]),A=u(()=>"Previa: "+a.value.estimate_number),U=u(()=>s.orderBy==="asc"||s.orderBy==null);u(()=>U.value?y("general.ascending"):y("general.descending")),u(()=>`/estimates/pdf/${a.value.unique_hash}`),u(()=>a.value&&a.value.id?estimate.value.id:null),ie(c,(e,B)=>{e.name==="estimates.view"&&C()}),k(),C(),L=oe.exports.debounce(L,500);async function k(e,B=!1){if(_.value)return;let n={};s.searchText!==""&&s.searchText!==null&&s.searchText!==void 0&&(n.search=s.searchText),s.orderBy!==null&&s.orderBy!==void 0&&(n.orderBy=s.orderBy),s.orderByField!==null&&s.orderByField!==void 0&&(n.orderByField=s.orderByField),_.value=!0;let E=await d.fetchEstimates({page:e,...n});_.value=!1,r.value=r.value?r.value:[],r.value=[...r.value,...E.data.data],x.value=e||1,I.value=E.data.meta.last_page;let D=r.value.find(P=>P.id==c.params.id);B==!1&&!D&&x.value<I.value&&Object.keys(n).length===0&&k(++x.value),D&&setTimeout(()=>{B==!1&&R()},500)}function $(){w.value=!0}function q(){w.value=!1}function R(){const e=document.getElementById(`estimate-${c.params.id}`);e&&(e.scrollIntoView({behavior:"smooth"}),e.classList.add("shake"),z())}function z(){V.value.addEventListener("scroll",e=>{e.target.scrollTop>0&&e.target.scrollTop+e.target.clientHeight>e.target.scrollHeight-200&&x.value<I.value&&k(++x.value,!0)})}async function C(){b.value=!0;let e=await d.fetchEstimate(c.params.id);e.data&&(b.value=!1,a.value={...e.data.data})}async function L(){r.value=[],k()}async function Z(e){g.openModal({title:y("estimates.send_estimate"),componentName:"SendEstimateModal",id:a.value.id,data:a.value})}return(e,B)=>{const n=v("BaseButton"),E=v("BasePageHeader"),D=v("router-link"),P=v("BaseTable"),G=v("BasePage");return S(),M(ne,null,[a.value?(S(),F(G,{key:0,class:O({"w-1/2":w.value})},{default:o(()=>[f(E,{title:A.value},{actions:o(()=>[a.value.status==="DRAFT"&&N(h).hasAbilities(N(re).SEND_ESTIMATE)?(S(),F(n,{key:0,"content-loading":b.value,variant:"primary",class:"text-sm",onClick:Z},{default:o(()=>[m(p(e.$t("estimates.send_estimate")),1)]),_:1},8,["content-loading"])):j("",!0),f(de,{class:"ml-3",row:a.value},null,8,["row"])]),_:1},8,["title"]),t("div",we,[f(P,{data:a.value.items,columns:H.value,loading:b.value,actionRow:"openItemDetail",onOpenItemDetail:$},{"cell-id":o(({row:i})=>[f(D,{to:$,class:"font-medium text-primary-500"},{default:o(()=>[m(p(i.data.id),1)]),_:2},1024)]),"cell-name":o(({row:i})=>[m(p(i.data.name),1)]),"cell-quantity":o(({row:i})=>[m(p(i.data.quantity),1)]),"cell-precision_price":o(({row:i})=>[m(p(i.data.precision_price),1)]),"cell-total":o(({row:i})=>[m(p(i.data.total),1)]),_:1},8,["data","columns","loading"])])]),_:1},8,["class"])):j("",!0),f(be,{estimateItemDetailOpen:w.value,onCloseEstimateitemdetail:q},null,8,["estimateItemDetailOpen"])],64)}}};export{Ee as default};
