import{ac as Q,ag as W,J as X,H as Y,l as Z,m as ee,M as te,d as _,e as v,v as se,r as d,o as B,j as S,h as l,b as p,a as s,n as ae,z as oe,t as $,x as e,g as q,c as ne,w as re,p as i,q as x,L as w,ah as L,s as le,a0 as ie,ai as ue,aj as b}from"./main.67344fb0.js";import{u as de}from"./users.9f58b7fe.js";import{_ as ce}from"./CreateCustomFields.60b5c5db.js";const me={class:"flex items-center justify-end"},pe={class:"grid grid-cols-5 gap-4 mb-8"},ge={class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},_e={class:"grid grid-cols-5 gap-2 mb-8"},ve={key:0,class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},fe={class:"col-span-5 lg:col-span-4"},F="customFields",$e={__name:"Create",setup(he){const t=Q(),y=W(),U=X(),k=Y(),V=de(),{t:o}=Z(),D=ee(),G=te();let c=_(!1);_(!1),_(!1),_(!1);const f=_(!1),g=v(()=>G.name==="customers.edit");let P=v(()=>t.isFetchingInitialSettings);const M=v(()=>g.value?o("customers.edit_customer"):o("customers.new_customer")),N=v(()=>({currentCustomer:{name:{required:i.withMessage(o("validation.required"),x),minLength:i.withMessage(o("validation.name_min_length",{count:3}),w(3))},prefix:{minLength:i.withMessage(o("validation.name_min_length",{count:3}),w(3))},currency_id:{required:i.withMessage(o("validation.required"),x)},email:{required:i.withMessage(o("validation.required"),L(t.currentCustomer.enable_portal==!0)),email:i.withMessage(o("validation.email_incorrect"),le)},password:{required:i.withMessage(o("validation.required"),L(t.currentCustomer.enable_portal==!0&&!t.currentCustomer.password_added)),minLength:i.withMessage(o("validation.password_min_length",{count:8}),w(8))},confirm_password:{sameAsPassword:i.withMessage(o("validation.password_incorrect"),ie(t.currentCustomer.password))},website:{url:i.withMessage(o("validation.invalid_url"),ue)},billing:{address_street_1:{maxLength:i.withMessage(o("validation.address_maxlength",{count:255}),b(255))},address_street_2:{maxLength:i.withMessage(o("validation.address_maxlength",{count:255}),b(255))}},shipping:{address_street_1:{maxLength:i.withMessage(o("validation.address_maxlength",{count:255}),b(255))},address_street_2:{maxLength:i.withMessage(o("validation.address_maxlength",{count:255}),b(255))}}}}));v(()=>`${window.location.origin}/${k.selectedCompany.slug}/customer/login`);const u=se(N,t,{$scope:F});t.resetCurrentCustomer(),t.fetchCustomerInitialSettings(g.value),V.fetchUsers();async function j(){if(u.value.$touch(),u.value.$invalid)return!0;f.value=!0;let n={...t.currentCustomer},a=null;try{a=await(g.value?t.updateCustomer:t.addCustomer)(n)}catch{f.value=!1;return}D.push(`/admin/customers/${a.data.data.id}/view`)}return(n,a)=>{const h=d("BaseBreadcrumbItem"),A=d("BaseBreadcrumb-item"),H=d("BaseBreadcrumb"),z=d("BaseIcon"),E=d("BaseButton"),R=d("BasePageHeader"),C=d("BaseInput"),m=d("BaseInputGroup"),I=d("BaseMultiselect"),T=d("BaseInputGrid"),J=d("BaseDivider"),K=d("BaseCard"),O=d("BasePage");return B(),S(O,null,{default:l(()=>[p("form",{onSubmit:re(j,["prevent"])},[s(R,{title:M.value},{actions:l(()=>[p("div",me,[s(E,{type:"submit",loading:f.value,disabled:f.value},{left:l(r=>[s(z,{name:"SaveIcon",class:ae(r.class)},null,8,["class"])]),default:l(()=>[oe(" "+$(g.value?n.$t("customers.update_customer"):n.$t("customers.save_customer")),1)]),_:1},8,["loading","disabled"])])]),default:l(()=>[s(H,null,{default:l(()=>[s(h,{title:n.$t("general.home"),to:"dashboard"},null,8,["title"]),s(h,{title:n.$tc("customers.customer",2),to:"/admin/customers"},null,8,["title"]),s(A,{title:M.value,to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),s(K,{class:"mt-5"},{default:l(()=>[p("div",pe,[p("h6",ge,$(n.$t("customers.basic_info")),1),s(T,{class:"col-span-5 lg:col-span-4"},{default:l(()=>[s(m,{label:n.$t("customers.display_name"),required:"",error:e(u).currentCustomer.name.$error&&e(u).currentCustomer.name.$errors[0].$message,"content-loading":e(c)},{default:l(()=>[s(C,{modelValue:e(t).currentCustomer.name,"onUpdate:modelValue":a[0]||(a[0]=r=>e(t).currentCustomer.name=r),"content-loading":e(c),type:"text",name:"name",class:"",invalid:e(u).currentCustomer.name.$error,onInput:a[1]||(a[1]=r=>e(u).currentCustomer.name.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","error","content-loading"]),s(m,{label:n.$t("customers.primary_contact_name"),"content-loading":e(c)},{default:l(()=>[s(C,{modelValue:e(t).currentCustomer.contact_name,"onUpdate:modelValue":a[2]||(a[2]=r=>e(t).currentCustomer.contact_name=r),modelModifiers:{trim:!0},"content-loading":e(c),type:"text"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),s(m,{error:e(u).currentCustomer.email.$error&&e(u).currentCustomer.email.$errors[0].$message,"content-loading":e(c),label:n.$t("customers.email")},{default:l(()=>[s(C,{modelValue:e(t).currentCustomer.email,"onUpdate:modelValue":a[3]||(a[3]=r=>e(t).currentCustomer.email=r),modelModifiers:{trim:!0},"content-loading":e(c),type:"text",name:"email",invalid:e(u).currentCustomer.email.$error,onInput:a[4]||(a[4]=r=>e(u).currentCustomer.email.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["error","content-loading","label"]),s(m,{label:n.$t("customers.phone"),"content-loading":e(c)},{default:l(()=>[s(C,{modelValue:e(t).currentCustomer.phone,"onUpdate:modelValue":a[5]||(a[5]=r=>e(t).currentCustomer.phone=r),modelModifiers:{trim:!0},"content-loading":e(c),type:"text",name:"phone"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),s(m,{label:n.$t("customers.primary_currency"),"content-loading":e(c),error:e(u).currentCustomer.currency_id.$error&&e(u).currentCustomer.currency_id.$errors[0].$message,required:""},{default:l(()=>[s(I,{modelValue:e(t).currentCustomer.currency_id,"onUpdate:modelValue":a[6]||(a[6]=r=>e(t).currentCustomer.currency_id=r),"value-prop":"id",label:"name","track-by":"name","content-loading":e(c),options:e(U).currencies,searchable:"","can-deselect":!1,placeholder:n.$t("customers.select_currency"),invalid:e(u).currentCustomer.currency_id.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","content-loading","error"]),s(m,{label:"Asesor","content-loading":e(c),required:""},{default:l(()=>[s(I,{modelValue:e(t).currentCustomer.manager_id,"onUpdate:modelValue":a[7]||(a[7]=r=>e(t).currentCustomer.manager_id=r),"value-prop":"id",label:"name","track-by":"name","content-loading":e(c),options:e(V).users,searchable:"","can-deselect":!1,placeholder:n.$t("customers.manager"),class:"w-full"},null,8,["modelValue","content-loading","options","placeholder"])]),_:1},8,["content-loading"])]),_:1})]),e(y).customFields.length>0?(B(),S(J,{key:0,class:"mb-5 md:mb-8"})):q("",!0),p("div",_e,[e(y).customFields.length>0?(B(),ne("h6",ve,$(n.$t("settings.custom_fields.title")),1)):q("",!0),p("div",fe,[s(ce,{type:"Customer",store:e(t),"store-prop":"currentCustomer","is-edit":g.value,"is-loading":e(P),"custom-field-scope":F},null,8,["store","is-edit","is-loading"])])])]),_:1})],32)]),_:1})}}};export{$e as default};
