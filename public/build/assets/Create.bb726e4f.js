import{ac as O,ag as Q,J as W,H as X,p as a,l as Y,m as ee,M as te,d as p,e as _,v as se,r as l,o as B,j as q,h as u,b as m,a as r,n as ae,z as re,t as b,x as e,g as S,c as oe,w as ne,q as $,L as w,ah as V,s as le,a0 as ie,ai as ue,aj as h}from"./main.6170b91d.js";import{u as ce}from"./users.b657b192.js";import{_ as de}from"./CreateCustomFields.0f7fa867.js";const me={class:"flex items-center justify-end"},ge={class:"grid grid-cols-5 gap-4 mb-8"},pe={class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},_e={class:"grid grid-cols-5 gap-2 mb-8"},ve={key:0,class:"col-span-5 text-lg font-semibold text-left lg:col-span-1"},fe={class:"col-span-5 lg:col-span-4"},x="customFields",$e={__name:"Create",setup(he){const t=O(),M=Q(),F=W(),L=X();ce();const R=a.regex(/^([A-Z&]{3,4})\d{6}(?:[A-Z\d]{3})?$/),{t:s}=Y(),k=ee(),D=te();let d=p(!1);p(!1),p(!1),p(!1);const v=p(!1),g=_(()=>D.name==="customers.edit");let G=_(()=>t.isFetchingInitialSettings);const y=_(()=>g.value?s("customers.edit_customer"):s("customers.new_customer")),P=_(()=>({currentCustomer:{name:{required:a.withMessage(s("validation.required"),$),minLength:a.withMessage(s("validation.name_min_length",{count:3}),w(3))},rfc:{required:a.withMessage(s("validation.required"),$),validRFC:a.withMessage("El formato del RFC no es correcto",R)},prefix:{minLength:a.withMessage(s("validation.name_min_length",{count:3}),w(3))},currency_id:{required:a.withMessage(s("validation.required"),$)},email:{required:a.withMessage(s("validation.required"),V(t.currentCustomer.enable_portal==!0)),email:a.withMessage(s("validation.email_incorrect"),le)},password:{required:a.withMessage(s("validation.required"),V(t.currentCustomer.enable_portal==!0&&!t.currentCustomer.password_added)),minLength:a.withMessage(s("validation.password_min_length",{count:8}),w(8))},confirm_password:{sameAsPassword:a.withMessage(s("validation.password_incorrect"),ie(t.currentCustomer.password))},website:{url:a.withMessage(s("validation.invalid_url"),ue)},billing:{address_street_1:{maxLength:a.withMessage(s("validation.address_maxlength",{count:255}),h(255))},address_street_2:{maxLength:a.withMessage(s("validation.address_maxlength",{count:255}),h(255))}},shipping:{address_street_1:{maxLength:a.withMessage(s("validation.address_maxlength",{count:255}),h(255))},address_street_2:{maxLength:a.withMessage(s("validation.address_maxlength",{count:255}),h(255))}}}}));_(()=>`${window.location.origin}/${L.selectedCompany.slug}/customer/login`);const o=se(P,t,{$scope:x});t.resetCurrentCustomer(),t.fetchCustomerInitialSettings(g.value);async function A(){if(o.value.$touch(),o.value.$invalid)return!0;v.value=!0;let i={...t.currentCustomer},n=null;try{n=await(g.value?t.updateCustomer:t.addCustomer)(i)}catch{v.value=!1;return}k.push(`/admin/customers/${n.data.data.id}/view`)}return(i,n)=>{const f=l("BaseBreadcrumbItem"),N=l("BaseBreadcrumb-item"),U=l("BaseBreadcrumb"),j=l("BaseIcon"),E=l("BaseButton"),H=l("BasePageHeader"),I=l("BaseInput"),C=l("BaseInputGroup"),z=l("BaseMultiselect"),T=l("BaseInputGrid"),Z=l("BaseDivider"),J=l("BaseCard"),K=l("BasePage");return B(),q(K,null,{default:u(()=>[m("form",{onSubmit:ne(A,["prevent"])},[r(H,{title:y.value},{actions:u(()=>[m("div",me,[r(E,{type:"submit",loading:v.value,disabled:v.value},{left:u(c=>[r(j,{name:"SaveIcon",class:ae(c.class)},null,8,["class"])]),default:u(()=>[re(" "+b(g.value?i.$t("customers.update_customer"):i.$t("customers.save_customer")),1)]),_:1},8,["loading","disabled"])])]),default:u(()=>[r(U,null,{default:u(()=>[r(f,{title:i.$t("general.home"),to:"dashboard"},null,8,["title"]),r(f,{title:i.$tc("customers.customer",2),to:"/admin/customers"},null,8,["title"]),r(N,{title:y.value,to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),r(J,{class:"mt-5"},{default:u(()=>[m("div",ge,[m("h6",pe,b(i.$t("customers.basic_info")),1),r(T,{class:"col-span-5 lg:col-span-4"},{default:u(()=>[r(C,{label:i.$t("customers.rfc"),required:"",error:e(o).currentCustomer.rfc.$error&&e(o).currentCustomer.rfc.$errors[0].$message,"content-loading":e(d)},{default:u(()=>[r(I,{modelValue:e(t).currentCustomer.rfc,"onUpdate:modelValue":n[0]||(n[0]=c=>e(t).currentCustomer.rfc=c),"content-loading":e(d),type:"text",name:"name",class:"",invalid:e(o).currentCustomer.rfc.$error,onInput:n[1]||(n[1]=c=>e(o).currentCustomer.rfc.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","error","content-loading"]),r(C,{label:i.$t("customers.legal_name"),required:"",error:e(o).currentCustomer.name.$error&&e(o).currentCustomer.name.$errors[0].$message,"content-loading":e(d)},{default:u(()=>[r(I,{modelValue:e(t).currentCustomer.name,"onUpdate:modelValue":n[2]||(n[2]=c=>e(t).currentCustomer.name=c),"content-loading":e(d),type:"text",name:"name",class:"",invalid:e(o).currentCustomer.name.$error,onInput:n[3]||(n[3]=c=>e(o).currentCustomer.name.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","error","content-loading"]),r(C,{label:"Regimen Fiscal","content-loading":e(d),error:e(o).currentCustomer.currency_id.$error&&e(o).currentCustomer.currency_id.$errors[0].$message,required:""},{default:u(()=>[r(z,{modelValue:e(t).currentCustomer.sat_regime_id,"onUpdate:modelValue":n[4]||(n[4]=c=>e(t).currentCustomer.sat_regime_id=c),"value-prop":"id",label:"name","track-by":"name","content-loading":e(d),options:e(F).satRegimes,searchable:"","can-deselect":!1,placeholder:i.$t("customers.select_currency"),invalid:e(o).currentCustomer.currency_id.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["content-loading","error"])]),_:1})]),e(M).customFields.length>0?(B(),q(Z,{key:0,class:"mb-5 md:mb-8"})):S("",!0),m("div",_e,[e(M).customFields.length>0?(B(),oe("h6",ve,b(i.$t("settings.custom_fields.title")),1)):S("",!0),m("div",fe,[r(de,{type:"Customer",store:e(t),"store-prop":"currentCustomer","is-edit":g.value,"is-loading":e(G),"custom-field-scope":x},null,8,["store","is-edit","is-loading"])])])]),_:1})],32)]),_:1})}}};export{$e as default};
