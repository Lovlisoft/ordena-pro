import{a7 as L,r as l,o as d,c as x,a as t,x as n,h as s,H as R,ag as z,ax as O,l as W,M as Y,m as A,d as S,e as f,p,q as w,aj as J,ah as K,W as Q,v as X,E as Z,j as I,g as C,b as y,t as q,n as ee,z as ne,w as te,F as oe}from"./main.03e9c030.js";import{_ as ie,a as ae,b as se,c as le}from"./SalesTax.90bafacd.js";import{_ as ce}from"./CreateTotal.e2791292.js";import{_ as re}from"./ExchangeRateConverter.da67b7c6.js";/* empty css                                                  */import{_ as ue}from"./TaxTypeModal.052a7a88.js";import"./DragIcon.b5507118.js";import"./exchange-rate.0aabc5af.js";const de={class:"grid grid-cols-12 gap-8 mt-6 mb-8"},me={__name:"InvoiceCreateBasicFields",props:{v:{type:Object,default:null},isLoading:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1}},setup(o){const e=L();return(m,c)=>{const B=l("BaseCustomerSelectPopup"),r=l("BaseDatePicker"),v=l("BaseInputGroup"),$=l("BaseInput"),u=l("BaseInputGrid");return d(),x("div",de,[t(B,{modelValue:n(e).newInvoice.customer,"onUpdate:modelValue":c[0]||(c[0]=a=>n(e).newInvoice.customer=a),valid:o.v.customer_id,"content-loading":o.isLoading,type:"invoice",class:"col-span-12 lg:col-span-5 pr-0"},null,8,["modelValue","valid","content-loading"]),t(u,{class:"col-span-12 lg:col-span-7"},{default:s(()=>[t(v,{label:m.$t("invoices.invoice_date"),"content-loading":o.isLoading,required:"",error:o.v.invoice_date.$error&&o.v.invoice_date.$errors[0].$message},{default:s(()=>[t(r,{modelValue:n(e).newInvoice.invoice_date,"onUpdate:modelValue":c[1]||(c[1]=a=>n(e).newInvoice.invoice_date=a),"content-loading":o.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),t(v,{label:m.$t("invoices.due_date"),"content-loading":o.isLoading},{default:s(()=>[t(r,{modelValue:n(e).newInvoice.due_date,"onUpdate:modelValue":c[2]||(c[2]=a=>n(e).newInvoice.due_date=a),"content-loading":o.isLoading,"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),t(v,{label:m.$t("invoices.invoice_number"),"content-loading":o.isLoading,error:o.v.invoice_number.$error&&o.v.invoice_number.$errors[0].$message,required:""},{default:s(()=>[t($,{modelValue:n(e).newInvoice.invoice_number,"onUpdate:modelValue":c[3]||(c[3]=a=>n(e).newInvoice.invoice_number=a),"content-loading":o.isLoading,onInput:c[4]||(c[4]=a=>o.v.invoice_number.$touch())},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading","error"]),t(re,{store:n(e),"store-prop":"newInvoice",v:o.v,"is-loading":o.isLoading,"is-edit":o.isEdit,"customer-currency":n(e).newInvoice.currency_id},null,8,["store","v","is-loading","is-edit","customer-currency"])]),_:1})])}}},ve={class:"flex"},ge={class:"block mt-10 invoice-foot lg:flex lg:justify-between lg:items-start"},pe=y("div",{class:"relative w-full lg:w-1/2 lg:mr-4"},null,-1),k="newInvoice",he={__name:"InvoiceCreate",setup(o){const e=L(),m=R(),c=z(),B=O(),{t:r}=W();let v=Y(),$=A(),u=S(!1);S(!1),S(["customer","company","customerCustom","invoice","invoiceCustom"]);let a=f(()=>e.isFetchingInvoice||e.isFetchingInitialSettings),P=f(()=>_.value?r("invoices.edit_invoice"):r("invoices.new_invoice"));const E=f(()=>m.selectedCompanySettings.sales_tax_us_enabled==="YES"&&B.salesTaxUSEnabled);let _=f(()=>v.name==="invoices.edit");const F={invoice_date:{required:p.withMessage(r("validation.required"),w)},reference_number:{maxLength:p.withMessage(r("validation.price_maxlength"),J(255))},customer_id:{required:p.withMessage(r("validation.required"),w)},invoice_number:{required:p.withMessage(r("validation.required"),w)},exchange_rate:{required:K(function(){return p.withMessage(r("validation.required"),w),e.showExchangeRate}),decimal:p.withMessage(r("validation.valid_exchange_rate"),Q)}},b=X(F,f(()=>e.newInvoice),{$scope:k});c.resetCustomFields(),b.value.$reset,e.resetCurrentInvoice(),e.fetchInvoiceInitialSettings(_.value),Z(()=>e.newInvoice.customer,i=>{i&&i.currency?e.newInvoice.selectedCurrency=i.currency:e.newInvoice.selectedCurrency=m.selectedCompanyCurrency});async function M(){if(b.value.$touch(),b.value.$invalid)return!1;u.value=!0;let i={...e.newInvoice,sub_total:e.getSubTotal,total:e.getTotal,tax:e.getTotalTax};try{const g=await(_.value?e.updateInvoice:e.addInvoice)(i);$.push(`/admin/invoices/${g.data.data.id}/view`)}catch(h){console.error(h)}u.value=!1}return(i,h)=>{const g=l("BaseBreadcrumbItem"),T=l("BaseBreadcrumb"),V=l("BaseButton"),U=l("router-link"),j=l("BaseIcon"),G=l("BasePageHeader"),N=l("BaseScrollPane"),D=l("BasePage");return d(),x(oe,null,[t(ie),t(ae),t(ue),E.value&&(!n(a)||n(v).query.customer)?(d(),I(se,{key:0,store:n(e),"is-edit":n(_),"store-prop":"newInvoice",customer:n(e).newInvoice.customer},null,8,["store","is-edit","customer"])):C("",!0),t(D,{class:"relative invoice-create-page"},{default:s(()=>[y("form",{onSubmit:te(M,["prevent"])},[t(G,{title:n(P)},{actions:s(()=>[i.$route.name==="invoices.edit"?(d(),I(U,{key:0,to:`/invoices/pdf/${n(e).newInvoice.unique_hash}`,target:"_blank"},{default:s(()=>[t(V,{class:"mr-3",variant:"primary-outline",type:"button"},{default:s(()=>[y("span",ve,q(i.$t("general.view_pdf")),1)]),_:1})]),_:1},8,["to"])):C("",!0),t(V,{loading:n(u),disabled:n(u),variant:"primary",type:"submit"},{left:s(H=>[n(u)?C("",!0):(d(),I(j,{key:0,name:"SaveIcon",class:ee(H.class)},null,8,["class"]))]),default:s(()=>[ne(" "+q(i.$t("invoices.save_invoice")),1)]),_:1},8,["loading","disabled"])]),default:s(()=>[t(T,null,{default:s(()=>[t(g,{title:i.$t("general.home"),to:"/admin/dashboard"},null,8,["title"]),t(g,{title:i.$tc("invoices.invoice",2),to:"/admin/invoices"},null,8,["title"]),i.$route.name==="invoices.edit"?(d(),I(g,{key:0,title:i.$t("invoices.edit_invoice"),to:"#",active:""},null,8,["title"])):(d(),I(g,{key:1,title:i.$t("invoices.new_invoice"),to:"#",active:""},null,8,["title"]))]),_:1})]),_:1},8,["title"]),t(me,{v:n(b),"is-loading":n(a),"is-edit":n(_)},null,8,["v","is-loading","is-edit"]),t(N,null,{default:s(()=>[t(le,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(a),"item-validation-scope":k,store:n(e),"store-prop":"newInvoice"},null,8,["currency","is-loading","store"]),y("div",ge,[pe,t(ce,{currency:n(e).newInvoice.selectedCurrency,"is-loading":n(a),store:n(e),"store-prop":"newInvoice","tax-popup-type":"invoice"},null,8,["currency","is-loading","store"])])]),_:1})],32)]),_:1})],64)}}};export{he as default};
