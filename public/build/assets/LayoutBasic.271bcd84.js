import{aN as z,J as P,B as E,a0 as ue,k as L,L as N,M as J,N as me,T as ae,r as p,o,l as B,w as a,h as n,i as S,t as g,u as e,f as t,e as _,m as U,j as V,U as H,G as K,C as pe,aO as _e,F,y as T,Y as ye,a5 as fe,a2 as Q,a3 as he,a6 as ge,aP as ve,D as be}from"./vendor.ae2d842a.js";import{b as X,c as Y,d as O,e as W,a as xe,f as oe,g as j,u as we}from"./main.88a58514.js";import{u as ne}from"./exchange-rate.8fabf773.js";import{N as $e}from"./NotificationRoot.eca43707.js";import{V as Ce}from"./index.esm.4119b3a0.js";const ke={class:"flex justify-between w-full"},Be=["onSubmit"],Se={class:"p-4 mb-16 sm:p-6 space-y-4"},Ie={key:1,class:"flex flex-col items-center"},Me={class:"z-0 flex justify-end p-4 bg-gray-50 border-modal-bg"},Ee={setup(R){const y=z(),s=X(),c=Y(),f=O(),{t:u}=P();let h=E(!1),x=E(null),r=E(!1),i=E(null),d=E(null);const m=ue({name:null,currency:"",address:{country_id:null}}),v=L(()=>c.active&&c.componentName==="CompanyModal"),w={newCompanyForm:{name:{required:N.withMessage(u("validation.required"),J),minLength:N.withMessage(u("validation.name_min_length",{count:3}),me(3))},address:{country_id:{required:N.withMessage(u("validation.required"),J)}},currency:{required:N.withMessage(u("validation.required"),J)}}},l=ae(w,{newCompanyForm:m});async function I(){r.value=!0,await f.fetchCurrencies(),await f.fetchCountries(),m.currency=s.selectedCompanyCurrency.id,m.address.country_id=s.selectedCompany.address.country_id,r.value=!1}function $(C,k){d.value=C,i.value=k}function b(){d.value=null,i.value=null}async function M(){if(l.value.newCompanyForm.$touch(),l.value.$invalid)return!0;h.value=!0;try{const C=await s.addNewCompany(m);if(C.data.data){if(await s.setSelectedCompany(C.data.data),i&&i.value){let k=new FormData;k.append("company_logo",JSON.stringify({name:d.value,data:i.value})),await s.updateCompanyLogo(k),y.push("/admin/dashboard")}await f.setIsAppLoaded(!1),await f.bootstrap(),q()}h.value=!1}catch{h.value=!1}}function D(){m.name="",m.currency="",m.address.country_id="",l.value.$reset()}function q(){c.closeModal(),setTimeout(()=>{D(),l.value.$reset()},300)}return(C,k)=>{const Z=p("BaseIcon"),se=p("BaseContentPlaceholdersBox"),re=p("BaseContentPlaceholders"),le=p("BaseFileUploader"),G=p("BaseInputGroup"),ie=p("BaseInput"),ee=p("BaseMultiselect"),ce=p("BaseInputGrid"),te=p("BaseButton"),de=p("BaseModal");return o(),B(de,{show:e(v),onClose:q,onOpen:I},{header:a(()=>[n("div",ke,[S(g(e(c).title)+" ",1),t(Z,{name:"XIcon",class:"w-6 h-6 text-gray-500 cursor-pointer",onClick:q})])]),default:a(()=>[n("form",{action:"",onSubmit:H(M,["prevent"])},[n("div",Se,[t(ce,{layout:"one-column"},{default:a(()=>[t(G,{"content-loading":e(r),label:C.$tc("settings.company_info.company_logo")},{default:a(()=>[e(r)?(o(),B(re,{key:0},{default:a(()=>[t(se,{rounded:!0,class:"w-full h-24"})]),_:1})):(o(),_("div",Ie,[t(le,{"preview-image":e(x),base64:"",onRemove:b,onChange:$},null,8,["preview-image"])]))]),_:1},8,["content-loading","label"]),t(G,{label:C.$tc("settings.company_info.company_name"),error:e(l).newCompanyForm.name.$error&&e(l).newCompanyForm.name.$errors[0].$message,"content-loading":e(r),required:""},{default:a(()=>[t(ie,{modelValue:e(m).name,"onUpdate:modelValue":k[0]||(k[0]=A=>e(m).name=A),invalid:e(l).newCompanyForm.name.$error,"content-loading":e(r),onInput:k[1]||(k[1]=A=>e(l).newCompanyForm.name.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","error","content-loading"]),t(G,{"content-loading":e(r),label:C.$tc("settings.company_info.country"),error:e(l).newCompanyForm.address.country_id.$error&&e(l).newCompanyForm.address.country_id.$errors[0].$message,required:""},{default:a(()=>[t(ee,{modelValue:e(m).address.country_id,"onUpdate:modelValue":k[2]||(k[2]=A=>e(m).address.country_id=A),"content-loading":e(r),label:"name",invalid:e(l).newCompanyForm.address.country_id.$error,options:e(f).countries,"value-prop":"id","can-deselect":!0,"can-clear":!1,searchable:"","track-by":"name"},null,8,["modelValue","content-loading","invalid","options"])]),_:1},8,["content-loading","label","error"]),t(G,{label:C.$t("wizard.currency"),error:e(l).newCompanyForm.currency.$error&&e(l).newCompanyForm.currency.$errors[0].$message,"content-loading":e(r),"help-text":C.$t("wizard.currency_set_alert"),required:""},{default:a(()=>[t(ee,{modelValue:e(m).currency,"onUpdate:modelValue":k[3]||(k[3]=A=>e(m).currency=A),"content-loading":e(r),options:e(f).currencies,label:"name","value-prop":"id",searchable:!0,"track-by":"name",placeholder:C.$tc("settings.currencies.select_currency"),invalid:e(l).newCompanyForm.currency.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading","help-text"])]),_:1})]),n("div",Me,[t(te,{class:"mr-3 text-sm",variant:"primary-outline",outline:"",type:"button",onClick:q},{default:a(()=>[S(g(C.$t("general.cancel")),1)]),_:1}),t(te,{loading:e(h),disabled:e(h),variant:"primary",type:"submit"},{left:a(A=>[e(h)?V("",!0):(o(),B(Z,{key:0,name:"SaveIcon",class:U(A.class)},null,8,["class"]))]),default:a(()=>[S(" "+g(C.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],40,Be)]),_:1},8,["show"])}}},Ve={key:0,class:"w-16 text-sm font-medium truncate sm:w-auto"},Ae={key:0,class:"absolute right-0 mt-2 bg-white rounded-md shadow-lg"},Ue={class:"overflow-y-auto scrollbar-thin scrollbar-thumb-rounded-full w-[250px] max-h-[350px] scrollbar-thumb-gray-300 scrollbar-track-gray-10 pb-4"},Fe={class:"px-3 py-2 text-xs font-semibold text-gray-400 mb-0.5 block uppercase"},Re={key:0,class:"flex flex-col items-center justify-center p-2 px-3 mt-4 text-base text-gray-400"},Ne={key:1},Te={key:0},je=["onClick"],De={class:"flex items-center"},Le={class:"flex items-center justify-center mr-3 overflow-hidden text-base font-semibold bg-gray-200 rounded-md w-9 h-9 text-primary-500"},Oe={key:0},qe=["src"],Ge={class:"flex flex-col"},ze={class:"text-sm"},Pe={class:"font-medium"},Je={setup(R){const y=X(),s=Y(),c=K(),f=z(),u=O(),{t:h}=P(),x=W(),r=E(!1),i=E(""),d=E(null);pe(c,()=>{r.value=!1,i.value=""}),_e(d,()=>{r.value=!1});function m(l){if(l)return l.split(" ")[0].charAt(0).toUpperCase()}function v(){s.openModal({title:h("company_switcher.new_company"),componentName:"CompanyModal",size:"sm"})}async function w(l){await y.setSelectedCompany(l),f.push("/admin/dashboard"),await u.setIsAppLoaded(!1),await u.bootstrap()}return(l,I)=>{const $=p("BaseIcon");return o(),_("div",{ref:(b,M)=>{M.companySwitchBar=b,d.value=b},class:"relative rounded"},[t(Ee),n("div",{class:"flex items-center justify-center px-3 h-8 md:h-9 ml-2 text-sm text-white bg-white rounded cursor-pointer bg-opacity-20",onClick:I[0]||(I[0]=b=>r.value=!r.value)},[e(y).selectedCompany?(o(),_("span",Ve,g(e(y).selectedCompany.name),1)):V("",!0),t($,{name:"ChevronDownIcon",class:"h-5 ml-1 text-white"})]),t(ye,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:a(()=>[r.value?(o(),_("div",Ae,[n("div",Ue,[n("label",Fe,g(l.$t("company_switcher.label")),1),e(y).companies.length<1?(o(),_("div",Re,[t($,{name:"ExclamationCircleIcon",class:"h-5 text-gray-400"}),S(" "+g(l.$t("company_switcher.no_results_found")),1)])):(o(),_("div",Ne,[e(y).companies.length>0?(o(),_("div",Te,[(o(!0),_(F,null,T(e(y).companies,(b,M)=>(o(),_("div",{key:M,class:U(["p-2 px-3 rounded-md cursor-pointer hover:bg-gray-100 hover:text-primary-500",{"bg-gray-100 text-primary-500":e(y).selectedCompany.id===b.id}]),onClick:D=>w(b)},[n("div",De,[n("span",Le,[b.logo?(o(),_("img",{key:1,src:b.logo,alt:"Company logo",class:"w-full h-full object-contain"},null,8,qe)):(o(),_("span",Oe,g(m(b.name)),1))]),n("div",Ge,[n("span",ze,g(b.name),1)])])],10,je))),128))])):V("",!0)]))]),e(x).currentUser.is_owner?(o(),_("div",{key:0,class:"flex items-center justify-center p-4 pl-3 border-t-2 border-gray-100 cursor-pointer text-primary-400 hover:text-primary-500",onClick:v},[t($,{name:"PlusIcon",class:"h-5 mr-2"}),n("span",Pe,g(l.$t("company_switcher.add_new_company")),1)])):V("",!0)])):V("",!0)]),_:1})],512)}}},Xe={class:"fixed top-0 left-0 z-20 flex items-center justify-between w-full px-4 py-3 md:h-16 md:px-8 bg-gradient-to-r from-primary-500 to-primary-400"},Ye=["onClick"],He={class:"flex float-right h-8 m-0 list-none md:h-9"},Ke={key:0,class:"relative hidden float-left m-0 md:block"},Qe={class:"flex items-center justify-center w-8 h-8 ml-2 text-sm text-black bg-white rounded md:h-9 md:w-9"},We={class:"relative block float-left ml-2"},Ze=["src"],et={setup(R){const y=xe(),s=W(),c=O(),f=z(),u=L(()=>s.currentUser&&s.currentUser.avatar!==0?s.currentUser.avatar:h());L(()=>c.globalSettings.admin_portal_logo?"/storage/"+c.globalSettings.admin_portal_logo:!1);function h(){return new URL("/img/default-avatar.jpg",self.location)}function x(){return s.hasAbilities([j.CREATE_INVOICE,j.CREATE_ESTIMATE,j.CREATE_CUSTOMER])}async function r(){await y.logout(),f.push("/login")}function i(){c.setSidebarVisibility(!0)}return(d,m)=>{const v=p("router-link"),w=p("BaseIcon"),l=p("BaseDropdownItem"),I=p("BaseDropdown");return o(),_("header",Xe,[t(v,{to:"/admin/dashboard",class:"float-none text-lg not-italic font-black tracking-wider text-white brand-main md:float-left font-base hidden md:block"},{default:a(()=>[t(oe,{class:"h-6"})]),_:1}),n("div",{class:U([{"is-active":e(c).isSidebarOpen},"flex float-left p-1 overflow-visible text-sm ease-linear bg-white border-0 rounded cursor-pointer md:hidden md:ml-0 hover:bg-gray-100"]),onClick:H(i,["prevent"])},[t(w,{name:"MenuIcon",class:"!w-6 !h-6 text-gray-500"})],10,Ye),n("ul",He,[x?(o(),_("li",Ke,[t(I,{"width-class":"w-48"},{activator:a(()=>[n("div",Qe,[t(w,{name:"PlusIcon",class:"w-5 h-5 text-gray-600"})])]),default:a(()=>[t(v,{to:"/admin/invoices/create"},{default:a(()=>[e(s).hasAbilities(e(j).CREATE_INVOICE)?(o(),B(l,{key:0},{default:a(()=>[t(w,{name:"DocumentTextIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),S(" "+g(d.$t("invoices.new_invoice")),1)]),_:1})):V("",!0)]),_:1}),t(v,{to:"/admin/estimates/create"},{default:a(()=>[e(s).hasAbilities(e(j).CREATE_ESTIMATE)?(o(),B(l,{key:0},{default:a(()=>[t(w,{name:"DocumentIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),S(" "+g(d.$t("estimates.new_estimate")),1)]),_:1})):V("",!0)]),_:1}),t(v,{to:"/admin/customers/create"},{default:a(()=>[e(s).hasAbilities(e(j).CREATE_CUSTOMER)?(o(),B(l,{key:0},{default:a(()=>[t(w,{name:"UserIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),S(" "+g(d.$t("customers.new_customer")),1)]),_:1})):V("",!0)]),_:1})]),_:1})])):V("",!0),n("li",null,[t(Je)]),n("li",We,[t(I,{"width-class":"w-48"},{activator:a(()=>[n("img",{src:e(u),class:"block w-8 h-8 rounded md:h-9 md:w-9 object-cover"},null,8,Ze)]),default:a(()=>[t(v,{to:"/admin/settings/account-settings"},{default:a(()=>[t(l,null,{default:a(()=>[t(w,{name:"CogIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),S(" "+g(d.$t("navigation.settings")),1)]),_:1})]),_:1}),t(l,{onClick:r},{default:a(()=>[t(w,{name:"LogoutIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500","aria-hidden":"true"}),S(" "+g(d.$t("navigation.logout")),1)]),_:1})]),_:1})])])])}}},tt={class:"relative flex flex-col flex-1 w-full max-w-xs bg-white"},at={class:"absolute top-0 right-0 pt-2 -mr-12"},ot=n("span",{class:"sr-only"},"Close sidebar",-1),nt={class:"flex-1 h-0 pt-5 pb-4 overflow-y-auto"},st={class:"flex items-center shrink-0 px-4 mb-10"},rt=n("div",{class:"shrink-0 w-14"},null,-1),lt={class:"hidden w-56 h-screen pb-32 overflow-y-auto bg-white border-r border-gray-200 border-solid xl:w-64 md:fixed md:flex md:flex-col md:inset-y-0 pt-16"},it={setup(R){const y=K(),s=O();function c(f){return y.path.indexOf(f)>-1}return(f,u)=>{const h=p("BaseIcon"),x=p("router-link");return o(),_(F,null,[t(e(ge),{as:"template",show:e(s).isSidebarOpen},{default:a(()=>[t(e(fe),{as:"div",class:"fixed inset-0 z-40 flex md:hidden",onClose:u[3]||(u[3]=r=>e(s).setSidebarVisibility(!1))},{default:a(()=>[t(e(Q),{as:"template",enter:"transition-opacity ease-linear duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"transition-opacity ease-linear duration-300","leave-from":"opacity-100","leave-to":"opacity-0"},{default:a(()=>[t(e(he),{class:"fixed inset-0 bg-gray-600 bg-opacity-75"})]),_:1}),t(e(Q),{as:"template",enter:"transition ease-in-out duration-300","enter-from":"-translate-x-full","enter-to":"translate-x-0",leave:"transition ease-in-out duration-300","leave-from":"translate-x-0","leave-to":"-translate-x-full"},{default:a(()=>[n("div",tt,[t(e(Q),{as:"template",enter:"ease-in-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in-out duration-300","leave-from":"opacity-100","leave-to":"opacity-0"},{default:a(()=>[n("div",at,[n("button",{class:"flex items-center justify-center w-10 h-10 ml-1 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:u[0]||(u[0]=r=>e(s).setSidebarVisibility(!1))},[ot,t(h,{name:"XIcon",class:"w-6 h-6 text-white","aria-hidden":"true"})])])]),_:1}),n("div",nt,[n("div",st,[t(oe)]),(o(!0),_(F,null,T(e(s).menuGroups,r=>(o(),_("nav",{key:r,class:"mt-5 space-y-1"},[(o(!0),_(F,null,T(r,i=>(o(),B(x,{key:i.name,to:i.link,class:U([c(i.link)?"text-primary-500 border-primary-500 bg-gray-100 ":"text-black","cursor-pointer px-0 pl-4 py-3 border-transparent flex items-center border-l-4 border-solid text-sm not-italic font-medium"]),onClick:u[2]||(u[2]=d=>e(s).setSidebarVisibility(!1))},{default:a(()=>[t(h,{name:i.icon,class:U([c(i.link)?"text-primary-500 ":"text-gray-400","mr-4 shrink-0 h-5 w-5"]),onClick:u[1]||(u[1]=d=>e(s).setSidebarVisibility(!1))},null,8,["name","class"]),S(" "+g(f.$t(i.title)),1)]),_:2},1032,["to","class"]))),128))]))),128))])])]),_:1}),rt]),_:1})]),_:1},8,["show"]),n("div",lt,[(o(!0),_(F,null,T(e(s).menuGroups,r=>(o(),_("div",{key:r,class:"p-0 m-0 mt-6 list-none"},[(o(!0),_(F,null,T(r,i=>(o(),B(x,{key:i,to:i.link,class:U([c(i.link)?"text-primary-500 border-primary-500 bg-gray-100 ":"text-black","cursor-pointer px-0 pl-6 hover:bg-gray-50 py-3 group flex items-center border-l-4 border-solid border-transparent text-sm not-italic font-medium"])},{default:a(()=>[t(h,{name:i.icon,class:U([c(i.link)?"text-primary-500 group-hover:text-primary-500 ":"text-gray-400 group-hover:text-black","mr-4 shrink-0 h-5 w-5 "])},null,8,["name","class"]),S(" "+g(f.$t(i.title)),1)]),_:2},1032,["to","class"]))),128))]))),128))])],64)}}},ct={class:"font-medium text-lg text-left"},dt={class:"mt-2 text-sm leading-snug text-gray-500",style:{"max-width":"680px"}},ut=["onSubmit"],mt={class:"text-gray-500 sm:text-sm"},pt={class:"text-gray-400 text-xs mt-2 font-light"},_t={slot:"footer",class:"z-0 flex justify-end mt-4 pt-4 border-t border-gray-200 border-solid border-modal-bg"},yt={emits:["update"],setup(R,{emit:y}){const s=ne();we();const c=X(),{t:f,tm:u}=P();let h=E(!1);E(!1);const x={exchange_rate:{required:N.withMessage(f("validation.required"),J),decimal:N.withMessage(f("validation.valid_exchange_rate"),ve)}},r=ae();async function i(){if(r.value.$touch(),r.value.$invalid)return!0;h.value=!0;let d=s.bulkCurrencies.map(v=>({id:v.id,exchange_rate:v.exchange_rate})),m=await s.updateBulkExchangeRate({currencies:d});m.data.success&&y("update",m.data.success),h.value=!1}return(d,m)=>{const v=p("BaseInput"),w=p("BaseInputGroup"),l=p("BaseButton"),I=p("BaseCard");return o(),B(I,null,{default:a(()=>[n("h6",ct,g(d.$t("settings.exchange_rate.title")),1),n("p",dt,g(d.$t("settings.exchange_rate.description",{currency:e(c).selectedCompanyCurrency.name})),1),n("form",{action:"",onSubmit:H(i,["prevent"])},[(o(!0),_(F,null,T(e(s).bulkCurrencies,($,b)=>(o(),B(e(Ce),{key:b,state:$,rules:x},{default:a(({v:M})=>[t(w,{class:"my-5",label:`${$.code} to ${e(c).selectedCompanyCurrency.code}`,error:M.exchange_rate.$error&&M.exchange_rate.$errors[0].$message,required:""},{default:a(()=>[t(v,{modelValue:$.exchange_rate,"onUpdate:modelValue":D=>$.exchange_rate=D,addon:`1 ${$.code} =`,invalid:M.exchange_rate.$error,onInput:D=>M.exchange_rate.$touch()},{right:a(()=>[n("span",mt,g(e(c).selectedCompanyCurrency.code),1)]),_:2},1032,["modelValue","onUpdate:modelValue","addon","invalid","onInput"]),n("span",pt,g(d.$t("settings.exchange_rate.exchange_help_text",{currency:$.code,baseCurrency:e(c).selectedCompanyCurrency.code})),1)]),_:2},1032,["label","error"])]),_:2},1032,["state"]))),128)),n("div",_t,[t(l,{loading:e(h),variant:"primary",type:"submit"},{default:a(()=>[S(g(d.$t("general.save")),1)]),_:1},8,["loading"])])],40,ut)]),_:1})}}},ft={setup(R){const y=Y(),s=L(()=>y.active&&y.componentName==="ExchangeRateBulkUpdateModal");function c(){y.closeModal()}return(f,u)=>{const h=p("BaseModal");return o(),B(h,{show:e(s)},{default:a(()=>[t(yt,{onUpdate:u[0]||(u[0]=x=>c())})]),_:1},8,["show"])}}},ht={key:0,class:"h-full"},gt={class:"h-screen h-screen-ios overflow-y-auto md:pl-56 xl:pl-64 min-h-0"},vt={class:"pt-16 pb-16"},kt={setup(R){const y=O(),s=K(),c=W(),f=z(),u=Y();P();const h=ne(),x=X(),r=L(()=>y.isAppLoaded);return be(()=>{y.bootstrap().then(i=>{s.meta.ability&&!c.hasAbilities(s.meta.ability)?f.push({name:"account.settings"}):s.meta.isOwner&&!c.currentUser.is_owner&&f.push({name:"account.settings"}),i.data.current_company_settings.bulk_exchange_rate_configured==="NO"&&h.fetchBulkCurrencies().then(d=>{if(d.data.currencies.length)u.openModal({componentName:"ExchangeRateBulkUpdateModal",size:"sm"});else{let m={settings:{bulk_exchange_rate_configured:"YES"}};x.updateCompanySettings({data:m})}})})}),(i,d)=>{const m=p("router-view"),v=p("BaseGlobalLoader");return e(r)?(o(),_("div",ht,[t($e),t(et),t(it),t(ft),n("main",gt,[n("div",vt,[t(m)])])])):(o(),B(v,{key:1}))}}};export{kt as default};
