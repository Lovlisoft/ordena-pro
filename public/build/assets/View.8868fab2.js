import{_ as tt,o as h,c as $,$ as H,a3 as et,ab as U,a8 as N,N as j,l as O,M as q,m as R,r as y,j as I,h as s,a as n,x as m,Q as A,z as w,t as l,g as V,d,e as b,E as at,b as t,aO as st,w as lt,aP as Z,n as Q,aI as K,I as nt,K as ot,an as it,aQ as L,F as ct}from"./main.f9e4fe85.js";import{_ as rt}from"./EstimateIndexDropdown.c2c48f5c.js";const dt={},mt={version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512","xml:space":"preserve"},ut=H(`<path style="fill:#F2F2F2;" d="M509.653,113.512l-85.511-85.511c-1.505-1.503-3.543-2.347-5.669-2.347H93.528
	c-4.428,0-8.017,3.588-8.017,8.017v470.313c0,4.428,3.588,8.017,8.017,8.017h410.455c4.428,0,8.017-3.588,8.017-8.017V119.182
	C512,117.056,511.156,115.017,509.653,113.512z"></path><g><path style="fill:#E5E5E5;" d="M511.982,118.826c-0.089-1.996-0.912-3.893-2.33-5.312L424.14,28.002
		c-1.504-1.504-3.542-2.348-5.668-2.348h-0.356v85.156c0,4.427,3.589,8.017,8.017,8.017H511.982z"></path><path style="fill:#E5E5E5;" d="M93.528,25.653c-4.428,0-8.017,3.588-8.017,8.017v470.313c0,4.428,3.588,8.017,8.017,8.017h375.888
		L136.144,25.653H93.528z"></path></g><path style="fill:#666666;" d="M214.313,0H24.05C10.789,0,0,10.789,0,24.05v258.672c0,13.261,10.789,24.05,24.05,24.05h190.263
	c13.261,0,24.05-10.789,24.05-24.05V24.05C238.363,10.789,227.574,0,214.313,0z"></path><path style="fill:#F7D04A;" d="M358.614,247.983c-65.717,0-119.182,53.465-119.182,119.182s53.465,119.182,119.182,119.182
	s119.182-53.465,119.182-119.182S424.33,247.983,358.614,247.983z"></path><path style="fill:#F3B41B;" d="M382.129,462.831c-65.717,0-119.182-53.465-119.182-119.182c0-26.875,8.946-51.698,24.009-71.656
	c-28.845,21.772-47.525,56.331-47.525,95.172c0,65.717,53.465,119.182,119.182,119.182c38.841,0,73.4-18.68,95.172-47.525
	C433.828,453.885,409.005,462.831,382.129,462.831z"></path><path style="fill:#EB6836;" d="M376.915,360.217l-12.423-0.366v-44.528h28.326c4.428,0,8.017-3.588,8.017-8.017
	c0-4.428-3.588-8.017-8.017-8.017h-28.326v-9.086c0-4.428-3.588-8.017-8.017-8.017c-4.428,0-8.017,3.588-8.017,8.017v9.086h-8.017
	c-13.261,0-24.05,10.789-24.05,24.05v27.791c0,13.217,10.719,23.98,23.92,24.05l8.147,0.239v43.585h-24.05
	c-4.428,0-8.017,3.588-8.017,8.017s3.588,8.017,8.017,8.017h24.05v9.086c0,4.428,3.588,8.017,8.017,8.017
	c4.428,0,8.017-3.588,8.017-8.017v-9.086h12.292c13.261,0,24.05-10.789,24.05-24.05v-26.722
	C400.835,371.05,390.116,360.288,376.915,360.217z M340.679,359.151c-0.078-0.002-0.157-0.003-0.236-0.003
	c-4.421,0-8.017-3.596-8.017-8.017V323.34c0-4.421,3.596-8.017,8.017-8.017h8.017v44.057L340.679,359.151z M384.802,410.99
	c0,4.421-3.596,8.017-8.017,8.017h-12.292v-43.114l12.056,0.355c0.078,0.002,0.157,0.003,0.236,0.003
	c4.421,0,8.017,3.596,8.017,8.017V410.99z"></path><path style="fill:#F2F2F2;" d="M204.693,25.653H33.67c-4.428,0-8.017,3.588-8.017,8.017v42.756c0,4.428,3.588,8.017,8.017,8.017
	h171.023c4.428,0,8.017-3.588,8.017-8.017V33.67C212.71,29.242,209.122,25.653,204.693,25.653z"></path><g><path style="fill:#62C9CC;" d="M33.67,25.653c-4.428,0-8.017,3.588-8.017,8.017v42.756c0,4.428,3.588,8.017,8.017,8.017h34.739
		l58.789-58.789H33.67z"></path><path style="fill:#62C9CC;" d="M204.693,25.653h-29.929l-58.789,58.789h88.718c4.428,0,8.017-3.588,8.017-8.017V33.67
		C212.71,29.242,209.122,25.653,204.693,25.653z"></path></g><g><path style="fill:#EF9D3C;" d="M67.875,94.063H33.67c-4.428,0-8.017,3.588-8.017,8.017v34.205c0,4.428,3.588,8.017,8.017,8.017
		h34.205c4.428,0,8.017-3.588,8.017-8.017v-34.205C75.891,97.651,72.303,94.063,67.875,94.063z"></path><path style="fill:#EF9D3C;" d="M135.749,94.063h-34.205c-4.428,0-8.017,3.588-8.017,8.017v34.205c0,4.428,3.588,8.017,8.017,8.017
		h34.205c4.428,0,8.017-3.588,8.017-8.017v-34.205C143.766,97.651,140.178,94.063,135.749,94.063z"></path><path style="fill:#EF9D3C;" d="M67.875,162.472H33.67c-4.428,0-8.017,3.588-8.017,8.017v34.205c0,4.428,3.588,8.017,8.017,8.017
		h34.205c4.428,0,8.017-3.588,8.017-8.017v-34.205C75.891,166.06,72.303,162.472,67.875,162.472z"></path><path style="fill:#EF9D3C;" d="M135.749,162.472h-34.205c-4.428,0-8.017,3.588-8.017,8.017v34.205c0,4.428,3.588,8.017,8.017,8.017
		h34.205c4.428,0,8.017-3.588,8.017-8.017v-34.205C143.766,166.06,140.178,162.472,135.749,162.472z"></path><path style="fill:#EF9D3C;" d="M67.875,230.881H33.67c-4.428,0-8.017,3.588-8.017,8.017v34.205c0,4.428,3.588,8.017,8.017,8.017
		h34.205c4.428,0,8.017-3.588,8.017-8.017v-34.205C75.891,234.469,72.303,230.881,67.875,230.881z"></path><path style="fill:#EF9D3C;" d="M135.749,230.881h-34.205c-4.428,0-8.017,3.588-8.017,8.017v34.205c0,4.428,3.588,8.017,8.017,8.017
		h34.205c4.428,0,8.017-3.588,8.017-8.017v-34.205C143.766,234.469,140.178,230.881,135.749,230.881z"></path><path style="fill:#EF9D3C;" d="M204.159,94.063h-34.205c-4.428,0-8.017,3.588-8.017,8.017v34.205c0,4.428,3.588,8.017,8.017,8.017
		h34.205c4.428,0,8.017-3.588,8.017-8.017v-34.205C212.175,97.651,208.587,94.063,204.159,94.063z"></path></g><path style="fill:#F7D04A;" d="M204.693,162.472h-34.205c-4.428,0-8.017,3.588-8.017,8.017v102.614c0,4.428,3.588,8.017,8.017,8.017
	h34.205c4.428,0,8.017-3.588,8.017-8.017V170.489C212.71,166.06,209.122,162.472,204.693,162.472z"></path><path style="fill:#666666;" d="M297.846,92.994c-2.183,0-4.358-0.886-5.941-2.632l-15.51-17.102
	c-2.974-3.279-2.727-8.35,0.554-11.324c3.276-2.976,8.349-2.729,11.324,0.554l15.51,17.102c2.974,3.279,2.727,8.35-0.554,11.324
	C301.695,92.308,299.767,92.994,297.846,92.994z"></path><g><path style="fill:#62C9CC;" d="M464.11,214.126L336.377,86.391c-1.12-1.119-2.545-1.882-4.097-2.192l-30.233-6.046
		c-2.627-0.522-5.344,0.297-7.241,2.192c-1.894,1.895-2.717,4.612-2.192,7.241l6.046,30.233c0.31,1.552,1.073,2.977,2.192,4.097
		l127.735,127.735c5.116,5.116,12.417,7.67,19.607,6.89c6.428-0.697,11.449-3.932,15.917-8.402
		C473.488,238.761,473.488,223.505,464.11,214.126z"></path><rect x="300.46" y="122.86" transform="matrix(-0.7071 -0.7071 0.7071 -0.7071 514.0678 508.8909)" style="fill:#62C9CC;" width="123.937" height="50.238"></rect></g><path style="fill:#F7D04A;" d="M302.047,78.153c-5.513-1.096-10.535,3.916-9.433,9.433l6.046,30.233
	c0.31,1.552,1.073,2.977,2.192,4.097l35.525-35.525c-1.12-1.119-2.545-1.882-4.097-2.192L302.047,78.153z"></path><path style="fill:#50A9A9;" d="M464.11,214.126l-40.095-40.095l-35.525,35.525l40.095,40.095c5.021,5.021,12.2,7.479,19.248,6.84
	c6.562-0.595,11.719-3.795,16.276-8.351C473.488,238.761,473.488,223.505,464.11,214.126z"></path><path style="fill:#666666;" d="M451.639,221.01c-2.051,0-4.103-0.782-5.669-2.347c-3.131-3.132-3.131-8.207,0-11.338l12.323-12.322
	l-37.701-35.802c-3.211-3.05-3.342-8.124-0.293-11.333c3.051-3.211,8.125-3.342,11.333-0.293l43.668,41.467
	c1.568,1.489,2.469,3.548,2.496,5.71c0.028,2.161-0.819,4.243-2.346,5.772l-18.14,18.14
	C455.742,220.226,453.69,221.01,451.639,221.01z"></path><g><path style="fill:#808080;" d="M198.28,383.733h-53.445c-4.428,0-8.017-3.588-8.017-8.017c0-4.428,3.588-8.017,8.017-8.017h53.445
		c4.428,0,8.017,3.588,8.017,8.017C206.296,380.145,202.708,383.733,198.28,383.733z"></path><path style="fill:#808080;" d="M198.28,426.489h-53.445c-4.428,0-8.017-3.588-8.017-8.017s3.588-8.017,8.017-8.017h53.445
		c4.428,0,8.017,3.588,8.017,8.017S202.708,426.489,198.28,426.489z"></path></g>`,16),ht=[ut];function pt(a,C){return h(),$("svg",mt,ht)}var ft=tt(dt,[["render",pt]]);const vt={__name:"AttachedFileDropdown",props:{file:{type:Object,default:null}},setup(a){et("utils"),U(),N();const C=j();return O(),q(),R(),(o,c)=>{const v=y("BaseIcon"),g=y("BaseDropdownItem"),p=y("router-link"),e=y("BaseDropdown");return h(),I(e,null,{activator:s(()=>[n(v,{class:"text-gray-500",name:"DotsHorizontalIcon"})]),default:s(()=>[m(C).hasAbilities(m(A).VIEW_ESTIMATE)?(h(),I(p,{key:0,to:"/nada/"},{default:s(()=>[n(g,null,{default:s(()=>[n(v,{name:"EyeIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),w(" "+l(o.$t("general.view")),1)]),_:1})]),_:1})):V("",!0),m(C).hasAbilities(m(A).DELETE_ESTIMATE)?(h(),I(g,{key:1,onClick:c[0]||(c[0]=k=>o.$emit("deleteFile"))},{default:s(()=>[n(v,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),w(" "+l(o.$t("general.delete")),1)]),_:1})):V("",!0)]),_:1})}}},_t={class:"mt-6"},yt=t("div",{class:"text-sm font-semibold text-gray-800 dark:text-gray-100 mb-2"},"Archivo Previa (PDF)",-1),gt={key:0},xt={class:"relative block cursor-pointer text-left w-full"},wt=t("input",{type:"radio",name:"radio-buttons",class:"peer sr-only",checked:""},null,-1),bt={class:"p-4 rounded-lg border border-gray-200 hover:border-gray-300 shadow-sm transition"},Ct={class:"grid grid-cols-12 items-center"},kt={class:"col-span-2 order-1 sm:order-none flex items-center space-x-4 p-2"},Et=t("div",{class:"col-span-7 order-2 sm:order-none text-left sm:text-center"},[t("div",{class:"text-sm font-medium text-gray-800 dark:text-gray-100 truncate"},"Nombre del archivo.pdf")],-1),It={class:"col-span-3 order-2 sm:order-none text-right"},Dt={__name:"FileAttachedTo",props:{file:{type:Object,default:null},types:{type:String,default:".pdf"},modelType:{type:String,default:null,required:!0},modelId:{type:Number,default:null,required:!0},collection:{type:String,default:null,required:!0}},emits:["update-parent-model"],setup(a,{emit:C}){const o=a,c=d(null),v=C,g=b(()=>c.value!==null);function p(u){c.value=u[0]}function e(){axios.delete(_.value).then(u=>{c.value=null})}const k=b(()=>"/api/v1/"+o.modelType+"/"+o.modelId+"/files?collection="+o.collection),_=b(()=>"/api/v1/"+o.modelType+"/"+o.modelId+"/files/"+c.value.id);return at(c,()=>{v("update-parent-model")}),(u,r)=>(h(),$("div",_t,[yt,g.value?(h(),$("div",gt,[t("label",xt,[wt,t("div",bt,[t("div",Ct,[t("div",kt,[n(ft)]),Et,t("div",It,[n(vt,{onDeleteFile:e})])])])])])):(h(),I(st,{key:1,modelValue:u.fileToUpload,"onUpdate:modelValue":r[0]||(r[0]=E=>u.fileToUpload=E),accept:a.types,onChange:u.fileChange,onUpload:p,autoProcess:!0,uploadUrl:k.value,inputFieldName:"file"},null,8,["modelValue","accept","onChange","uploadUrl"]))]))}},Mt={class:"sticky top-16 bg-gradient-to-b from-gray-100 to-white dark:from-[#151D2C] dark:to-gray-900 overflow-x-hidden overflow-y-auto no-scrollbar shrink-0 border-l border-gray-200 dark:border-gray-700/60 w-full sm:w-[calc(100dvw/2-128px)] 2xl:w-[calc(100dvw/3-80px)] h-[calc(100dvh-64px)]"},Bt=t("svg",{class:"fill-gray-400 group-hover:fill-gray-600 pointer-events-none",width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"m7.95 6.536 4.242-4.243a1 1 0 1 1 1.415 1.414L9.364 7.95l4.243 4.242a1 1 0 1 1-1.415 1.415L7.95 9.364l-4.243 4.243a1 1 0 0 1-1.414-1.415L6.536 7.95 2.293 3.707a1 1 0 0 1 1.414-1.414L7.95 6.536Z"})],-1),$t=[Bt],zt={class:"py-8 px-4 lg:px-8"},Ft={class:"max-w-sm mx-auto lg:max-w-none"},St={class:"text-gray-800 dark:text-gray-100 font-semibold text-center mb-1"},Tt={class:"text-sm text-center italic"},Pt={class:"drop-shadow-md mt-5"},Vt={class:"bg-white dark:bg-gray-800 rounded-t-xl px-5 pb-2.5 text-center pt-5"},At={class:"text-2xl font-semibold text-green-500 mb-1"},Lt={class:"text-sm font-medium text-gray-800 dark:text-gray-100 mb-3"},Ht=H('<div class="flex justify-between items-center" aria-hidden="true"><svg class="fill-white dark:fill-gray-800" width="20" height="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 20c5.523 0 10-4.477 10-10S5.523 0 0 0h20v20H0Z"></path></svg><div class="grow w-full h-5 bg-white dark:bg-gray-800 flex flex-col justify-center"><div class="h-px w-full border-t border-dashed border-gray-200 dark:border-gray-700"></div></div><svg class="fill-white dark:fill-gray-800 rotate-180" width="20" height="20" xmlns="http://www.w3.org/2000/svg"><path d="M0 20c5.523 0 10-4.477 10-10S5.523 0 0 0h20v20H0Z"></path></svg></div>',1),Ut={class:"bg-white dark:bg-gray-800 rounded-b-xl p-5 pt-2.5 text-sm space-y-3"},Nt={class:"flex justify-between space-x-1"},jt=t("span",{class:"italic"},"Partida:",-1),Ot={class:"font-medium text-gray-700 dark:text-gray-100 text-right"},qt={class:"flex justify-between space-x-1"},Rt=t("span",{class:"italic"},"Producto:",-1),Zt={class:"font-medium text-gray-700 dark:text-gray-100 text-right"},Qt={class:"flex justify-between space-x-1"},Kt=t("span",{class:"italic"},"Litros:",-1),Wt={class:"font-medium text-gray-700 dark:text-gray-100 text-right"},Gt={class:"flex justify-between space-x-1"},Jt=t("span",{class:"italic"},"Precio Unitario:",-1),Xt={class:"font-medium text-gray-700 dark:text-gray-100 text-right"},Yt={__name:"EstimateItemDetail",props:{estimateItemDetailOpen:{type:Boolean,default:!1},estimateItem:{type:Object},estimateData:{type:Object,required:!0}},emits:["close-estimateitemdetail"],setup(a,{emit:C}){const{formatMoney:o,formatNumber:c}=K,v=d(null),g=d(null);return(p,e)=>{var k,_,u,r,E,z,F,S,D,T,M,B,P,x;return h(),$("div",{ref_key:"panelContent",ref:v,class:Q(["absolute inset-0 sm:left-auto z-20 shadow-xl transition-transform duration-200 ease-in-out",a.estimateItemDetailOpen?"translate-x-0":"translate-x-full"])},[t("div",Mt,[t("button",{ref_key:"closeBtn",ref:g,onClick:e[0]||(e[0]=lt(f=>p.$emit("close-estimateitemdetail"),["stop"])),class:"absolute top-0 right-0 mt-6 mr-6 group p-2"},$t,512),t("div",zt,[t("div",Ft,[t("div",St,l((_=(k=a.estimateData)==null?void 0:k.customer)==null?void 0:_.rfc)+" "+l((r=(u=a.estimateData)==null?void 0:u.customer)==null?void 0:r.name),1),t("div",Tt,"Solicita: "+l((z=(E=a.estimateData)==null?void 0:E.creator)==null?void 0:z.name),1),t("div",Pt,[t("div",Vt,[t("div",At,l(m(o)((F=a.estimateItem)==null?void 0:F.total)),1),t("div",Lt,l((S=a.estimateItem)==null?void 0:S.name),1),n(Z,{status:(D=a.estimateItem)==null?void 0:D.status,class:"px-3 py-1"},{default:s(()=>{var f;return[w(l((f=a.estimateItem)==null?void 0:f.status_name),1)]}),_:1},8,["status"])]),Ht,t("div",Ut,[t("div",Nt,[jt,t("span",Ot,l(m(c)((T=a.estimateItem)==null?void 0:T.id)),1)]),t("div",qt,[Rt,t("span",Zt,l((M=a.estimateItem)==null?void 0:M.name),1)]),t("div",Qt,[Kt,t("span",Wt,l(m(c)((B=a.estimateItem)==null?void 0:B.quantity)),1)]),t("div",Gt,[Jt,t("span",Xt,l(m(o)((P=a.estimateItem)==null?void 0:P.precision_price,0,{itemPrecision:6})),1)])])]),n(Dt,{modelType:"estimate-items",modelId:(x=a.estimateItem)==null?void 0:x.id,types:".pdf",collection:"estimate_pdf",onUpdateParentModel:e[1]||(e[1]=f=>p.$emit("update-estimate-item"))},null,8,["modelId"])])])])],2)}}},te={class:"relative table-container pt-5"},se={__name:"View",setup(a){const{formatMoney:C,formatNumber:o}=K,c=nt(),v=U();N();const g=j(),{t:p}=O(),e=d(null),k=q();R(),d(!1),d(!1);const _=d(!1),u=d(null);d(1),d(1),d(null);const r=d(null),E=ot({orderBy:null,orderByField:null,searchText:null}),z=b(()=>[{key:"id",label:"Partida"},{key:"name",label:"Producto"},{key:"quantity",label:"Litros",thClass:"text-right",tdClass:"text-right"},{key:"precision_price",label:"Precio Unitario",thClass:"text-right",tdClass:"text-right"},{key:"total",label:"Total",thClass:"text-right",tdClass:"text-right"},{key:"status",label:"Estatus"}]),F=b(()=>"Previa: "+e.value.estimate_number),S=b(()=>E.orderBy==="asc"||E.orderBy==null);b(()=>S.value?p("general.ascending"):p("general.descending")),b(()=>e.value&&e.value.id?estimate.value.id:null),M(),B=it.exports.debounce(B,500);function D(x){r.value=x}function T(){r.value=null}async function M(x=!0){_.value=x;let f=await v.fetchEstimate(k.params.id);f.data&&(_.value=!1,e.value={...f.data.data})}async function B(){u.value=[],loadEstimates()}async function P(x){c.openModal({title:p("estimates.send_estimate"),componentName:"SendEstimateModal",id:e.value.id,data:e.value})}return(x,f)=>{const W=y("BaseButton"),G=y("BasePageHeader"),J=y("router-link"),X=y("BaseTable"),Y=y("BasePage");return h(),$(ct,null,[e.value?(h(),I(Y,{key:0,class:Q({"sm:w-1/2 lg:w-2/3":r.value!==null})},{default:s(()=>[n(G,{title:F.value},{actions:s(()=>[e.value.status==="DRAFT"&&m(g).hasAbilities(m(A).SEND_ESTIMATE)?(h(),I(W,{key:0,"content-loading":_.value,variant:"primary",class:"text-sm",onClick:P},{default:s(()=>[w(" Enviar a revisi\xF3n ")]),_:1},8,["content-loading"])):V("",!0),n(rt,{class:"ml-3",row:e.value},null,8,["row"])]),_:1},8,["title"]),t("div",te,[n(X,{data:e.value.items,columns:z.value,loading:_.value,actionRow:"openItemDetail",selectedRow:r.value,onOpenItemDetail:D},{"cell-id":s(({row:i})=>[n(J,{to:D,class:"font-medium text-primary-500"},{default:s(()=>[w(l(m(o)(i.data.id)),1)]),_:2},1024)]),"cell-name":s(({row:i})=>[w(l(i.data.name),1)]),"cell-quantity":s(({row:i})=>[w(l(m(o)(i.data.quantity)),1)]),"cell-precision_price":s(({row:i})=>[n(L,{amount:i.data.precision_price,precision:"6"},null,8,["amount"])]),"cell-total":s(({row:i})=>[n(L,{amount:i.data.total},null,8,["amount"])]),"cell-status":s(({row:i})=>[n(Z,{status:i.data.status,color:i.data.status_color,class:"px-3 py-1"},{default:s(()=>[w(l(i.data.status_name),1)]),_:2},1032,["status","color"])]),_:1},8,["data","columns","loading","selectedRow"])])]),_:1},8,["class"])):V("",!0),n(Yt,{estimateItemDetailOpen:r.value!==null,estimateItem:r.value,estimateData:e.value,onCloseEstimateitemdetail:T,onUpdateEstimateItem:f[0]||(f[0]=i=>M(!1))},null,8,["estimateItemDetailOpen","estimateItem","estimateData"])],64)}}};export{se as default};
